/**
  @license
  Dual-licensed: https://github.com/sybilla/meeus/blob/master/LICENSE.txt
 **/
(function(t){"object"===typeof exports&&"undefined"!==typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).meeus=t()})(function(){return function k(n,l,f){function h(d,a){if(!l[d]){if(!n[d]){var p="function"==typeof require&&require;if(!a&&p)return p(d,!0);if(e)return e(d,!0);p=Error("Cannot find module '"+d+"'");throw p.code="MODULE_NOT_FOUND",p;}p=l[d]={exports:{}};
n[d][0].call(p.exports,function(a){var e=n[d][1][a];return h(e?e:a)},p,p.exports,k,n,l,f)}return l[d].exports}for(var e="function"==typeof require&&require,a=0;a<f.length;a++)h(f[a]);return h}({1:[function(k,n,l){(function(d){d[d.Hour=0]="Hour";d[d.Degree=1]="Degree";d[d.Radian=2]="Radian"})(l.AngleStyle||(l.AngleStyle={}));var f=l.AngleStyle;(function(d){d[d.Reflective=0]="Reflective";d[d.Periodic=1]="Periodic"})(l.AngleNormalization||(l.AngleNormalization={}));var h=l.AngleNormalization,e=function(){function d(){}
d.parse=function(a,e,f){return d.matchToAngle(d.match(a,e,f))};d.match=function(a,e,f){null!=a&&(a=a.trim());for(var h=null,k=0;k<d.RegexPatterns.length;k++){var b=(new RegExp(d.RegexPatterns[k],"g")).exec(a);if(null!=b){void 0===f&&(a=e[k],f=void 0!==a?a:d.RegexPatternStyleMap[k]);h={match:b,style:f};break}}if(null==h)throw"s";return h};d.matchToAngle=function(d){var e=parseFloat(d.match[2]);isNaN(e)&&(e=0);var h=parseFloat(d.match[4]);isNaN(h)&&(h=0);var k=parseFloat(d.match[6]);isNaN(k)&&(k=0);
switch(d.style){case f.Hour:e=a.fromHours(e,h,k);break;case f.Degree:e=a.fromDegrees(e,h,k);break;case f.Radian:e=a.fromRadians(e);break;default:throw"style";}"-"===d.match[1]&&(e=e.negative());return e};d.RegexPatterns="d ([+-])?(\\d{1,3}):( )?(\\d{1,2}):?( )?(\\d{1,2}([\\.,]\\d+)?)?;([+-])?(\\d{1,3}):( )?(\\d{1,2}):?( )?(\\d{1,2}([\\.,]\\d+)?)?;d ([+-])?(\\d{1,3})( )(\\d{1,2})( )?(\\d{1,2}([\\.,]\\d+)?)?;([+-])?(\\d{1,3})( )(\\d{1,2})( )?(\\d{1,2}([\\.,]\\d+)?)?;([+-])?(\\d{1,3})h( )?(\\d{1,2})m( )?(\\d{1,2}([\\.,]\\d+)?)?[s]?;([+-])?(\\d{1,3})d( )?(\\d{1,2})m( )?(\\d{1,2}([\\.,]\\d+)?)?[s]?;([+-])?(\\d{1,3})[\u00b0*]( )?(\\d{1,2})\\'( )?(\\d{1,2}([.,]\\d+)?)?[\\\"]?;([a-zA-Z])(\\d{2})()(\\d{2})()(\\d{2}([\\.,]\\d+)?);([+-])?(\\d{2})()(\\d{2})()(\\d{2}([\\.,]\\d+)?)?;d ([+-])?(\\d{1,3}([\\.,]\\d+)?);([+-])?(\\d{1,3}([\\.,]\\d+)?)".split(";");
d.RegexPatternStyleMap={0:f.Degree,1:f.Degree,2:f.Degree,3:f.Degree,4:f.Hour,5:f.Degree,6:f.Degree,7:f.Hour,8:f.Degree,9:f.Degree,10:f.Radian};return d}();l.AngleParser=e;var a=function(){function d(a){this._dms=a*d.DegreeMillisecondsInDegree}Object.defineProperty(d.prototype,"hours",{get:function(){return this._dms/(d.DegreeMillisecondsInMillisecond*d.DegreeMillisecondsInDegree)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hour",{get:function(){return 0|this.hours},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"hourMinutes",{get:function(){return(0|this._dms/d.DegreeMillisecondsInMillisecond)%d.DegreeMillisecondsInDegree/d.DegreeMillisecondsInDegreeMinute},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hourMinute",{get:function(){return 0|this.hourMinutes},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hourSeconds",{get:function(){return(0|this._dms/d.DegreeMillisecondsInMillisecond)%d.DegreeMillisecondsInDegreeMinute/
d.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hourSecond",{get:function(){return 0|this.hourSeconds},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hourMilliseconds",{get:function(){return(0|this._dms/d.DegreeMillisecondsInMillisecond)%d.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hourMillisecond",{get:function(){return 0|this.hourMilliseconds},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"degrees",{get:function(){return this._dms/d.DegreeMillisecondsInDegree},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degree",{get:function(){return 0|this.degrees},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degreeMinutes",{get:function(){return(0|this._dms)%d.DegreeMillisecondsInDegree/d.DegreeMillisecondsInDegreeMinute},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degreeMinute",{get:function(){return 0|
this.degreeMinutes},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degreeSeconds",{get:function(){return(0|this._dms)%d.DegreeMillisecondsInDegreeMinute/d.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degreeSecond",{get:function(){return 0|this.degreeSeconds},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"degreeMilliseconds",{get:function(){return this._dms},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"degreeMillisecond",{get:function(){return 0|this.degreeMilliseconds},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"radians",{get:function(){return this.degrees*Math.PI/180},enumerable:!0,configurable:!0});d.prototype.addHours=function(a){return d.fromHours(this.hours+a)};d.prototype.addHourMinutes=function(a){return d.fromHours(this.hours,a)};d.prototype.addHourSeconds=function(a){return d.fromHours(this.hours,0,a)};d.prototype.addHourMilliseconds=function(a){return d.fromHours(this.hours,
0,0,a)};d.prototype.addDegrees=function(a){return d.fromDegrees(this.degrees+a)};d.prototype.addDegreeMinutes=function(a){return d.fromDegrees(this.degrees,a)};d.prototype.addDegreeSeconds=function(a){return d.fromDegrees(this.degrees,0,a)};d.prototype.addDegreeMilliseconds=function(a){return d.fromDegrees(this.degrees,0,0,a)};d.prototype.toFormattedString=function(a){a=a||{};var e=1,f="D",h=typeof a;"string"===h?f=a:"number"===h?e=a:(a.format=a.format||f,a.digits=null!=a.digits?a.digits:e,f=a.format,
e=a.digits);switch(f){case "H":return h=this.hourSeconds,a=this.hourMinute,f=this.hour,h=d.absPad(h,e),h=parseFloat(h),60<=h&&(h-=60,a+=1),60<=a&&(a-=60,f+=1),24<=f&&(f-=24),f+"h"+d.absPad(a)+"m"+d.absPad(h,e)+"s";case "D":a=0>this._dms?"-":"";var k=this.degreeSeconds,f=this.degreeMinute,h=this.degree,k=d.absPad(k,e),k=parseFloat(k);60<=k&&(k-=60,f+=1);60<=f&&(f-=60,h+=1);360<=h&&(h-=360);return a+Math.abs(h)+"\u00b0"+d.absPad(f)+"'"+d.absPad(k,e)+'"';case "R":return this.radians.toFixed(2).toString();
default:return""}};d.prototype.negative=function(){return d.fromDegrees(0,0,0,-this._dms)};d.prototype.normalize=function(a,d){a=a||0;d=void 0===d?h.Periodic:d;switch(d){case h.Reflective:return this.__normalizeReflective(a);case h.Periodic:return this.__normalizePeriodic(a);default:throw"normalization";}};d.prototype.__normalizeReflective=function(a){var e=a+180,f=this.__normalizeInternal(a-90);f<a?f=a+Math.min(Math.abs(f-a),Math.abs(f+a)):f>=e&&(f=e-Math.min(Math.abs(f-e),Math.abs(f+e)));return d.fromDegrees(f)};
d.prototype.__normalizePeriodic=function(a){return d.fromDegrees(this.__normalizeInternal(a))};d.prototype.__normalizeInternal=function(a){var d=this.degrees;a=(d-a)/360;0>a&&--a;return d-360*(0|a)};d.fromDegrees=function(a,f,e,h){a=(a||0)+(f||0)/60+(e||0)/3600+(h||0)/36E5;360<=Math.abs(a)&&(f=Math.floor(a),a-=f,a=f%360+a);return new d(a)};d.fromHours=function(a,f,e,h){a=(a||0)+(f||0)/60+(e||0)/3600+(h||0)/36E5;24<=Math.abs(a)&&(f=Math.floor(a),a-=f,a=f%24+a);return new d(a*d.DegreeMillisecondsInMillisecond)};
d.fromRadians=function(a){return d.fromDegrees(180*(a||0)/Math.PI)};d.parse=function(a,d){return e.parse(a,e.RegexPatternStyleMap,d)};d.absPad=function(a,d){d=d||0;var f=(10>a&&-10<a?"0":"")+(0<d?Math.abs(a).toFixed(d+1):Math.abs(a).toFixed(d));0<d&&(f=f.substr(0,d+3));return f};d.DegreeMillisecondsInDegree=36E5;d.DegreeMillisecondsInDegreeMinute=6E4;d.DegreeMillisecondsInDegreeSecond=1E3;d.DegreeMillisecondsInMillisecond=15;return d}();l.Angle=a},{}],2:[function(k,n,l){var f=k("../angle");k=function(){function h(f,
a){this.latitude=f;this.longitude=a}Object.defineProperty(h.prototype,"latitude",{get:function(){return this._lat},set:function(e){this._lat=e.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"longitude",{get:function(){return this._lon},set:function(f){this._lon=f.normalize(-180)},enumerable:!0,configurable:!0});h.prototype.toFormattedString=function(f){f=f||{};null==f.digits&&(f.digits=1);return this.latitude.toFormattedString({format:"D",
digits:f.digits})+" "+this.longitude.toFormattedString({format:"D",digits:f.digits})};h.parse=function(e,a,d){a=f.AngleParser.match(e,h.RegexPatternStyleMap,a);if(!a.match)throw"s";var k=f.AngleParser.matchToAngle(a);e=e.substr(e.indexOf(a.match[0])+a.match[0].length);a=f.AngleParser.match(e,h.RegexPatternStyleMap,d);if(!a.match)throw"s";d=f.AngleParser.matchToAngle(a);e.substr(e.indexOf(a.match[0])+a.match[0].length).trim();return new h(k,d)};h.RegexPatternStyleMap={7:f.AngleStyle.Degree,10:f.AngleStyle.Degree};
return h}();l.EclipticalCoordinates=k},{"../angle":1}],3:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function e(a,d){this.rightAscension=a;this.declination=d}Object.defineProperty(e.prototype,"rightAscension",{get:function(){return this._ra},set:function(a){this._ra=a.normalize()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"declination",{get:function(){return this._dec},set:function(a){this._dec=a.normalize(-90,f.AngleNormalization.Reflective)},
enumerable:!0,configurable:!0});e.prototype.toHorizontalCoordinates=function(a,d){return h.MeeusEngine.toHorizontalCoordinates(this,a,d)};e.prototype.toFormattedString=function(a){a=a||{};null==a.digits&&(a.digits=1);return this.rightAscension.toFormattedString({format:"H",digits:a.digits})+" "+this.declination.toFormattedString({format:"D",digits:a.digits})};e.parse=function(a,d,h){var k=f.AngleParser.match(a,e.RaPatternStyleMap,d);if(!k.match)throw"s";d=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+
k.match[0].length);k=f.AngleParser.match(a,e.DecPatternStyleMap,h);if(!k.match)throw"s";a=f.AngleParser.matchToAngle(k);return new e(d,a)};e.RaPatternStyleMap={1:f.AngleStyle.Hour,3:f.AngleStyle.Hour,8:f.AngleStyle.Hour,10:f.AngleStyle.Hour};e.DecPatternStyleMap={7:f.AngleStyle.Degree,10:f.AngleStyle.Degree};return e}();l.EquatorialCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],4:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function e(a,d,f){this.latitude=a;
this.longitude=d;this._alt=f||0}Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},set:function(a){this._lat=a.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"longitude",{get:function(){return this._lon},set:function(a){this._lon=a.normalize(-180)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"altitude",{get:function(){return this._alt},enumerable:!0,configurable:!0});e.prototype.sunrise=
function(a,d){return h.MeeusEngine.getSunriseAt(this,a,d)};e.prototype.sunset=function(a,d){return h.MeeusEngine.getSunsetAt(this,a,d)};e.prototype.toFormattedString=function(a){a=a||{};null==a.digits&&(a.digits=1);return this.latitude.toFormattedString({format:"D",digits:a.digits})+" "+this.longitude.toFormattedString({format:"D",digits:a.digits})+" "+this.altitude};e.parse=function(a,d,h){var k=f.AngleParser.match(a,e.RegexPatternStyleMap,d);if(!k.match)throw"s";d=f.AngleParser.matchToAngle(k);
a=a.substr(a.indexOf(k.match[0])+k.match[0].length);k=f.AngleParser.match(a,e.RegexPatternStyleMap,h);if(!k.match)throw"s";h=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+k.match[0].length).trim();a=parseFloat(a);isNaN(a)&&(a=0);return new e(d,h,a)};e.RegexPatternStyleMap={7:f.AngleStyle.Degree,10:f.AngleStyle.Degree};return e}();l.GeographicCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],5:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function e(a,
d){this.altitude=a;this.azimuth=d}Object.defineProperty(e.prototype,"altitude",{get:function(){return this._alt},set:function(a){this._alt=a.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"azimuth",{get:function(){return this._az},set:function(a){this._az=a.normalize()},enumerable:!0,configurable:!0});e.prototype.toEquatorialCoordinates=function(a,d){return h.MeeusEngine.toEquatorialCoordinates(this,a,d)};e.prototype.toFormattedString=
function(a){a=a||{};null==a.digits&&(a.digits=1);return this.altitude.toFormattedString({format:"D",digits:a.digits})+" "+this.azimuth.toFormattedString({format:"D",digits:a.digits})};e.parse=function(a,d,h){var k=f.AngleParser.match(a,e.RegexPatternStyleMap,d);if(!k.match)throw"s";d=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+k.match[0].length);k=f.AngleParser.match(a,e.RegexPatternStyleMap,h);if(!k.match)throw"s";a=f.AngleParser.matchToAngle(k);return new e(d,a)};e.RegexPatternStyleMap=
{7:f.AngleStyle.Degree,10:f.AngleStyle.Degree};return e}();l.HorizontalCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],6:[function(k,n,l){var f=k("../angle"),h=k("../datetime/utcdate"),e=k("../datetime/hjddate"),a=k("../datetime/ttdate"),d=k("../datetime/siderealtimes"),u=k("../datetime/taidate"),p=k("../coordinateSystems/geographicCoordinates"),r=k("../coordinateSystems/equatorialCoordinates"),v=k("../coordinateSystems/horizontalCoordinates");(function(b){b[b.Official=0]="Official";b[b.Astronomical=
1]="Astronomical";b[b.Nautical=2]="Nautical";b[b.Civil=3]="Civil"})(l.Twilight||(l.Twilight={}));var q=l.Twilight;k=function(){function b(){}b.getLeapSeconds=function(c){for(var g=null,m=0;m<b.LeapSeconds.length;m++){var a=b.LeapSeconds[m];if(a.utcdays<c){g=a.taiutc;break}}if(null==g)throw"days";return g.p1+(c-2400000.5-g.p2)*g.p3};b.toTaiDate=function(c){var g=b.getLeapSeconds(c.days);return new u.TaiDate(c.days+g/86400)};b.toTtDate=function(c){var g=b.getLeapSeconds(c.days)+b.TaiToTtOffsetSeconds;
return new a.TtDate(c.days+g/86400)};b.toGmsTime=function(c){c=c.daysSinceJ2000;var g=c/36525,m=g*g;return new d.GmsTime(b.normalize(280.46061837+360.98564736629*c+3.87933E-4*m-m*g/3871E4)/15)};b.toLmsTime=function(c,g){var m=g;m instanceof f.Angle?m=m.degrees:m instanceof p.GeographicCoordinates&&(m=m.longitude.degrees);var a=c.daysSinceJ2000,e=a/36525,h=e*e;return new d.LmsTime(b.normalize(280.46061837+360.98564736629*a+3.87933E-4*h-h*e/3871E4+m)/15)};b.toGasTime=function(c){return new d.GasTime(b.toGasDegrees(c)/
15)};b.toLasTime=function(c,g){var m=g;m instanceof f.Angle?m=m.degrees:m instanceof p.GeographicCoordinates&&(m=m.longitude.degrees);var a=b.toGasDegrees(c);return new d.LasTime(b.normalize(a+m)/15)};b.toHjdDate=function(c,g,m){g=b.earthPositionAt(c);g=b.equatorialToCartesian(g);m=b.equatorialToCartesian(m);m=b.MinsPerAU*(g.x*m.x+g.y*m.y+g.z*m.z);return(new e.HjdDate(c.days)).addMinutes(m)};b.getSunriseAt=function(c,g,m){return b.calc_SunriseOrSunset(!0,b.prepareJd(g||new Date),c,m||q.Official)};
b.getSunsetAt=function(c,g,m){return b.calc_SunriseOrSunset(!1,b.prepareJd(g||new Date),c,m||q.Official)};b.sunPositionAt=function(c){var g=b.preparePositionalParameters(c.centuriesSinceJ2000);c=g.sun.trueLongitude;var m=g.ecliptic.meanObliquity,g=b.datan2(b.dsin(c)*b.dcos(m)-b.dtan(0)*b.dsin(m),b.dcos(c));c=b.dasin(b.dsin(0)*b.dcos(m)+b.dcos(0)*b.dsin(m)*b.dsin(c));return new r.EquatorialCoordinates(f.Angle.fromDegrees(g),f.Angle.fromDegrees(c))};b.earthPositionAt=function(c){var g=b.preparePositionalParameters(c.centuriesSinceJ2000);
c=g.sun.trueLongitude;var m=g.ecliptic.meanObliquity,g=b.datan2(b.dsin(c)*b.dcos(m)-b.dtan(0)*b.dsin(m),b.dcos(c));c=b.dasin(b.dsin(0)*b.dcos(m)+b.dcos(0)*b.dsin(m)*b.dsin(c));g+=180;360<g&&(g-=360);c*=-1;return new r.EquatorialCoordinates(f.Angle.fromDegrees(g),f.Angle.fromDegrees(c))};b.moonPositionAt=function(c){var g=c.centuriesSinceJ2000,m=g*g,a=m*g;c=b.preparePositionalParameters(g);var d=c.sun.earthDistance,e=c.sun.meanAnomaly;c=c.ecliptic.meanObliquity;var h=b.calc_Moon_ArgumentOfLatitude(g,
m,a),k=b.calc_Moon_MeanLongitude(g);b.calc_Moon_LongitudeAscendingNode(g,m,a);var l=b.calc_Moon_MeanAnomaly(g,m,a),g=b.calc_Moon_MeanElongation(g,m,a),m=b.calc_Moon_Earth_Distance(l,g);b.calc_Moon_Sun_DistanceRatio(m,d);d=b.calc_Moon_GeocentricLatitude(h,l,g);h=b.calc_Moon_GeocentricLongitude(l,g,k,h,e);e=b.datan2(b.dsin(h)*b.dcos(c)-b.dtan(d)*b.dsin(c),b.dcos(h));c=b.dasin(b.dsin(d)*b.dcos(c)+b.dcos(d)*b.dsin(c)*b.dsin(h));return new r.EquatorialCoordinates(f.Angle.fromDegrees(e),f.Angle.fromDegrees(c))};
b.getAngularSeparation=function(c,g){var m=c.rightAscension.radians,a=c.declination.radians,d=g.rightAscension.radians,e=g.declination.radians;return f.Angle.fromDegrees(Math.atan2(Math.sqrt(Math.cos(e)*Math.sin(m-d)*Math.cos(e)*Math.sin(m-d)+(Math.cos(a)*Math.sin(e)-Math.cos(e)*Math.sin(a)*Math.cos(m-d))*(Math.cos(a)*Math.sin(e)-Math.cos(e)*Math.sin(a)*Math.cos(m-d))),Math.sin(a)*Math.sin(e)+Math.cos(a)*Math.cos(e)*Math.cos(m-d))*b.R2D)};b.toHorizontalCoordinates=function(c,g,m){var a;g instanceof
Date?a=h.UtcDate.fromDate(g):g instanceof h.UtcDate&&(a=g);c=b.fromJ2000(c,a);a=b.toLasTime(a,m.longitude.degrees);a=f.Angle.fromHours(a.hours-c.rightAscension.hours).normalize().radians;c=c.declination.radians;g=m.latitude.radians;var d=Math.asin(Math.sin(c)*Math.sin(g)+Math.cos(c)*Math.cos(g)*Math.cos(a));m=d*b.R2D;c=Math.acos((Math.sin(c)-Math.sin(d)*Math.sin(g))/(Math.cos(d)*Math.cos(g)))*b.R2D;0<Math.sin(a)&&(c=360-c);return new v.HorizontalCoordinates(b.toTopocentric(m),f.Angle.fromDegrees(c))};
b.toEquatorialCoordinates=function(c,g,m){var a;g instanceof Date?a=h.UtcDate.fromDate(g):g instanceof h.UtcDate&&(a=g);g=c.azimuth.degrees+180;360<=g&&(g-=360);g*=b.D2R;var d=m.latitude.radians;c=b.toGeocentric(c.altitude).radians;var e=f.Angle.fromRadians(Math.atan2(Math.sin(g),Math.cos(g)*Math.sin(d)+Math.tan(c)*Math.cos(d)));m=a.toLasTime(m.longitude.degrees);m=f.Angle.fromHours(m.hours-e.hours).normalize();g=Math.sin(d)*Math.sin(c)-Math.cos(d)*Math.cos(c)*Math.cos(g);if(-1>g||1<g)throw"Illegal value: "+
g+", should be in [-1,1].";return b.toJ2000(new r.EquatorialCoordinates(m,f.Angle.fromRadians(Math.asin(g))),a)};b.dsin=function(c){return Math.sin(b.D2R*c)};b.dcos=function(c){return Math.cos(b.D2R*c)};b.dtan=function(c){return Math.tan(b.D2R*c)};b.dasin=function(c){return b.R2D*Math.asin(c)};b.dacos=function(c){return b.R2D*Math.acos(c)};b.datan=function(c){return b.R2D*Math.atan(c)};b.datan2=function(c,g){var a;if(0==g&&0==c)return 0;a=b.datan(c/g);0>g&&(a+=180);0>c&&0<g&&(a+=360);return a};b.normalize=
function(c){return c-360*Math.floor(c/360)};b.addCartesian=function(c,g){return{x:c.x+g.x,y:c.y+g.y,z:c.z+g.z}};b.equatorialToCartesian=function(c){var g=c.rightAscension.radians;c=c.declination.radians;var b=Math.cos(c);return{x:Math.cos(g)*b,y:Math.sin(g)*b,z:Math.sin(c)}};b.geographicToCartesian=function(c,g){var b=g.toGasTime(),a=.017453292519943295*c.latitude.degrees,d=Math.sin(a),a=Math.cos(a),f=1/Math.sqrt(Math.pow(a,2)+.9933056213348961*Math.pow(d,2)),e=c.altitude/1E3,h=6378.14*f+e,b=.017453292519943295*
(15*b.hours+c.longitude.degrees);return{x:h*a*Math.cos(b)/149597870,y:h*a*Math.sin(b)/149597870,z:(6335.442315660955*f+e)*d/149597870}};b.preparePositionalParameters=function(c){var g=b.calc_Sun_MeanLongitude(c),a=b.calc_Sun_MeanAnomaly(c),d=b.calc_Sun_EqOfCenter(c,a),f=b.calc_Sun_TrueAnomaly(c,a,d),e=b.calc_Earth_OrbitEccentricity(c),g=b.calc_Sun_TrueLong(c,g,d),h=b.calc_Sun_LongitudeOfAscendingNode(c),h=b.calc_Sun_ApparentLong(c,g,h),k=b.calc_Ecliptic_MeanObliquity(c);c=b.calc_Sun_Earth_Distance(c,
e,a,d,f);return{sun:{trueLongitude:g,apparentLongitude:h,earthDistance:c,meanAnomaly:a},ecliptic:{meanObliquity:k}}};b.calc_Earth_OrbitEccentricity=function(c){return.016708634-c*(4.2037E-5+1.267E-7*c)};b.earthCartesianPositionAt=function(c){c=b.earthPositionAt(c);return b.equatorialToCartesian(c)};b.earthCartesianVelocityAt=function(c){var g=b.earthPositionAt(c);c=b.earthPositionAt(c.addMinutes(-1));g=b.equatorialToCartesian(g);c=b.equatorialToCartesian(c);return{x:(g.x-c.x)/7.04E-4,y:(g.y-c.y)/
7.04E-4,z:(g.z-c.z)/7.04E-4}};b.convertToHeliocentric=function(c,g){var a=b.earthCartesianPositionAt(g),d=b.geographicToCartesian(c,g);return{x:a.x+d.x,y:a.y+d.y,z:a.z+d.z}};b.calc_Ecliptic_MeanObliquity=function(c,g,b){g=g||c*c;return(21.448/60+26)/60+23+(-46.815*c-5.9E-4*g+.001813*(b||g*c))/3600};b.calc_Ecliptic_ObliquityCorrection=function(c,g){var a=g||b.calc_Ecliptic_MeanObliquity(c),d=b.calc_Sun_LongitudeOfAscendingNode(c);return a+.00256*Math.cos(b.D2R*d)};b.calc_Sun_Earth_Distance=function(c,
g,a,d,f){g=g||b.calc_Earth_OrbitEccentricity(c);a=a||b.calc_Sun_MeanAnomaly(c);d=d||b.calc_Sun_EqOfCenter(c,a);f=f||b.calc_Sun_TrueAnomaly(c,a,d);return.99972/(1+g*b.dcos(f))};b.calc_Sun_MeanLongitude=function(c){return b.normalize(280.46646+c*(36000.76983+3.032E-4*c))};b.calc_Sun_MeanAnomaly=function(c,g,a){g=g||c*c;return b.normalize(357.52772+35999.05034*c-1.603E-4*g-(a||c*g)/3E5)};b.calc_Sun_EqOfCenter=function(c,g){var a=g||b.calc_Sun_MeanAnomaly(c),a=b.D2R*a;return Math.sin(a)*(1.914602-c*(.004817+
1.4E-5*c))+Math.sin(a+a)*(.019993-1.01E-4*c)+2.89E-4*Math.sin(a+a+a)};b.calc_Sun_TrueLong=function(c,g,a){g=g||b.calc_Sun_MeanLongitude(c);c=a||b.calc_Sun_EqOfCenter(c);return g+c};b.calc_Sun_TrueAnomaly=function(c,g,a){g=g||b.calc_Sun_MeanAnomaly(c);c=a||b.calc_Sun_EqOfCenter(c);return g+c};b.calcSunRadVector=function(c,g,a){g=g||b.calc_Sun_TrueAnomaly(c);c=a||b.calc_Earth_OrbitEccentricity(c);return 1.000001018*(1-c*c)/(1+c*Math.cos(b.D2R*g))};b.calc_Sun_LongitudeOfAscendingNode=function(c,g,a){g=
g||c*c;return b.normalize(125.04452-1934.136261*c+.0020708*g+(a||g*c)/45E4)};b.calc_Sun_ApparentLong=function(c,g,a){g=g||b.calc_Sun_TrueLong(c);a=a||b.calc_Sun_LongitudeOfAscendingNode(c);return g-.00569-.00478*Math.sin(b.D2R*a)};b.calc_Moon_MeanAnomaly=function(c,g,a){g=g||c*c;return b.normalize(134.96298+477198.867398*c+.0086972*g+(a||g*c)/56250)};b.calc_Moon_MeanElongation=function(c,g,a){g=g||c*c;return b.normalize(297.85036+445267.11148*c-.0019142*g+(a||g*c)/189474)};b.calc_Moon_MeanLongitude=
function(c){return b.normalize(218.316+481267.8813*c)};b.calc_Moon_LongitudeAscendingNode=function(c,g,a){return b.normalize(125.045-1934.14*c+.002071*g+a/45E4)};b.calc_Moon_Earth_Distance=function(c,g){var a=2*g;return 1+(-20954*b.dcos(c)-3699*b.dcos(a-c)-2956*b.dcos(c))/385E3};b.calc_Moon_Sun_DistanceRatio=function(c,g){return c/g/379.168831168831};b.calc_Moon_GeocentricLatitude=function(c,g,a){a*=2;var d=5.128*b.dsin(c)+.2806*b.dsin(g+c);return d=d+.2777*b.dsin(g-c)+.1732*b.dsin(a-c)};b.calc_Moon_GeocentricLongitude=
function(c,g,a,d,f){g*=2;var e=6.289*b.dsin(c)+1.274*b.dsin(g-c)+.6583*b.dsin(g),e=e+.2136*b.dsin(2*c)-.1851*b.dsin(f)-.1143*b.dsin(2*d),e=e+.0588*b.dsin(g-2*c),e=e+.0572*b.dsin(g-f-c)+.0533*b.dsin(g+c);return e+a};b.calc_Moon_HeliocentricLatitude=function(c,g){return c*g};b.calc_Moon_HeliocentricLongitude=function(c,g,a,d){return b.normalize(c+180+180/Math.PI*g*b.dcos(a)*b.dsin(c-d))};b.calc_Moon_ArgumentOfLatitude=function(c,g,a){g=g||c*c;return b.normalize(93.27191+483202.017538*c-.0036825*g+(a||
g*c)/327270)};b.calc_Moon_LongitudeOfTerminator=function(c){var g=c.centuriesSinceJ2000,a=g*g,d=g*a;c=b.calc_Earth_OrbitEccentricity(g);var e=b.calc_Sun_MeanAnomaly(g,a,d),h=b.calc_Sun_EqOfCenter(g,e),k=b.calc_Sun_TrueAnomaly(g,e,h),l=b.calc_Sun_Earth_Distance(g,c,e,h,k);c=b.calc_Sun_LongitudeOfAscendingNode(g,a,d);var k=b.calc_Sun_MeanLongitude(g),h=b.calc_Sun_TrueLong(g,k,h),h=b.calc_Sun_ApparentLong(g,h,c),k=b.calc_Moon_MeanAnomaly(g,a,d),p=b.calc_Moon_MeanElongation(g,a,d),n=b.calc_Moon_Earth_Distance(k,
p),l=b.calc_Moon_Sun_DistanceRatio(n,l),a=b.calc_Moon_ArgumentOfLatitude(g,a,d),d=b.calc_Moon_GeocentricLatitude(a,k,p),g=b.calc_Moon_MeanLongitude(g),g=b.calc_Moon_GeocentricLongitude(k,p,g,a,e),e=b.calc_Moon_HeliocentricLatitude(l,d),g=b.calc_Moon_HeliocentricLongitude(h,l,e,g);c=b.normalize(g-c);g=b.dcos(c)*b.dcos(e);d=b.dsin(c)*b.dcos(e)*b.dcos(1.54242)-b.dsin(e)*b.dsin(1.54242);g=b.datan2(d,g);g=b.normalize(g-a);b.dasin(-b.dsin(c)*b.dcos(e)*b.dsin(1.54242)-b.dsin(e)*b.dcos(1.54242));c=90>g?90-
g:450-g;return f.Angle.fromDegrees(90<c&&270>c?180-c:90>c?0-c:360-c)};b.calc_Moon_IlluminatedDiscFraction=function(c){var g=c.centuriesSinceJ2000,a=g*g,d=g*a;c=b.calc_Earth_OrbitEccentricity(g);var f=b.calc_Sun_MeanAnomaly(g,a,d),e=b.calc_Sun_EqOfCenter(g,f),h=b.calc_Sun_TrueAnomaly(g,f,e);c=b.calc_Sun_Earth_Distance(g,c,f,e,h);var h=b.calc_Sun_LongitudeOfAscendingNode(g,a,d),k=b.calc_Sun_MeanLongitude(g),e=b.calc_Sun_TrueLong(g,k,e),k=b.calc_Sun_ApparentLong(g,e,h),l=b.calc_Moon_MeanAnomaly(g,a,
d),p=b.calc_Moon_MeanElongation(g,a,d),e=b.calc_Moon_Earth_Distance(l,p),e=b.calc_Moon_Sun_DistanceRatio(e,c),a=b.calc_Moon_ArgumentOfLatitude(g,a,d),d=b.calc_Moon_GeocentricLatitude(a,l,p),g=b.calc_Moon_MeanLongitude(g),f=b.calc_Moon_GeocentricLongitude(l,p,g,a,f),g=b.calc_Moon_HeliocentricLatitude(e,d),l=b.calc_Moon_HeliocentricLongitude(k,e,g,f),l=b.normalize(l-h),p=b.dcos(l)*b.dcos(g),h=b.dsin(l)*b.dcos(g)*b.dcos(1.54242)-b.dsin(g)*b.dsin(1.54242);b.normalize(b.datan2(h,p)-a);b.dasin(-b.dsin(l)*
b.dcos(g)*b.dsin(1.54242)-b.dsin(g)*b.dcos(1.54242));k=b.dcos(d)*b.dcos(f-k);h=90-b.datan(k/Math.sqrt(1-k*k));h=c*b.dsin(h);c=b.datan2(h,e-c*k);return(1+b.dcos(c))/2};b.calc_Ecliptic_NutationInLongitude=function(c,g,b,a,d,e){var f=-(171996+174.2*c)*Math.sin(g)-(13187+1.6*c)*Math.sin(-2*b+2*a+2*g)-(2274+.2*c)*Math.sin(2*a+2*g)+(2062+.2*c)*Math.sin(2*g)+(1426-3.4*c)*Math.sin(d)+(712+.1*c)*Math.sin(e),f=f+((-517+1.2*c)*Math.sin(-2*b+d+2*a+2*g)-(386+.4*c)*Math.sin(2*a+g)-301*Math.sin(e+2*a+2*g)+(217-
.5*c)*Math.sin(-2*b-d+2*a+2*g)-158*Math.sin(-2*b+e)),f=f+((129+.1*c)*Math.sin(-2*b+2*a+g)+123*Math.sin(-e+2*a+2*g)+63*Math.sin(2*b)+(63+.1*c)*Math.sin(e+g)-59*Math.sin(2*b-e+2*a+2*g)-(58+.1*c)*Math.sin(-e+g)),f=f-51*Math.sin(e+2*a+g),f=f+(48*Math.sin(-2*b+2*e)+46*Math.sin(-2*e+2*a+g)-38*Math.sin(2*b+2*a+2*g)-31*Math.sin(2*e+2*a+2*g)+29*Math.sin(2*e)+29*Math.sin(-2*b+e+2*a+2*g)+26*Math.sin(2*a)),f=f-(22*Math.sin(2*a-2*b)+21*Math.sin(2*a-e)+(17-.1*c)*Math.sin(2*d)+16*Math.sin(2*b-e+g)-(16-.1*c)*Math.sin(2*
(g+a+d-b))-15*Math.sin(d+g)-13*Math.sin(g+e-2*b)-12*Math.sin(g-d)),f=f+(11*Math.sin(2*(e-a))-10*Math.sin(2*b-e+2*a)-8*Math.sin(2*b+e+2*a+2*g)+7*Math.sin(d+2*a+2*g)-7*Math.sin(d+e-2*b)-7*Math.sin(2*a+2*g-d)-7*Math.sin(2*b+2*a+g)),f=f+6*Math.sin(2*b+e),f=f+(6*Math.sin(2*(g+a+e-b))+6*Math.sin(g+2*a+e-2*b)-6*Math.sin(2*b-2*e+g)-6*Math.sin(2*b+g)+5*Math.sin(e-d)-5*Math.sin(g+2*a-d-2*b)-5*Math.sin(g-2*b)-5*Math.sin(g+2*a+2*e)),f=f+(4*Math.sin(g-2*e-2*b)+4*Math.sin(g+2*a+d-2*b)+4*Math.sin(e-2*a)-4*Math.sin(e-
b)-4*Math.sin(d-2*b)-4*Math.sin(b)+3*Math.sin(2*a+e)-3*Math.sin(2*(g+a-e))-3*Math.sin(e-d-b)),f=f-3*Math.sin(e+d),f=f-(3*Math.sin(2*g+2*a+e-d)-3*Math.sin(2*g+2*a-e-d+2*b)-3*Math.sin(2*g+2*a+3*e)-3*Math.sin(2*g+2*a-d+2*b));return 1E-4/3600*f};b.calc_Ecliptic_MeanObliquityCorrection=function(c,g,b,a,d,e,f,h){g=(92025+8.9*c)*Math.cos(a)+(5736-3.1*c)*Math.cos(-2*d+2*e+2*a)+(977-.5*c)*Math.cos(2*e+2*a)+(-895+.5*c)*Math.cos(2*a)+(54-.1*c)*Math.cos(f)-7*Math.cos(h);g+=(224-.6*c)*Math.cos(-2*d+f+2*e+2*a)+
200*Math.cos(2*e+a)+(129-.1*c)*Math.cos(h+2*e+2*a)+(-95+.3*c)*Math.cos(-2*d-f+2*e+2*a)-70*Math.cos(-2*d+2*e+a);g-=53*Math.cos(-h+2*e+2*a)-33*Math.cos(h+a)+26*Math.cos(2*d-h+2*e+2*a)+32*Math.cos(-h+a)+27*Math.cos(h+2*e+a)-24*Math.cos(-2*h+2*e+a);g+=16*Math.cos(2*(d+e+a))+13*Math.cos(2*(h+e+a))-12*Math.cos(2*a+2*e+h-2*d)-10*Math.cos(a+2*e-h)-8*Math.cos(2*d-h+a)+7*Math.cos(2*(a+e+f-d))+9*Math.cos(f+a);g+=7*Math.cos(a+h-2*d)+6*Math.cos(a-f)+5*Math.cos(a+2*e-h+2*d)+3*Math.cos(2*a+2*e+h+2*d)-3*Math.cos(2*
a+2*e+f)+3*Math.cos(2*a+2*e-f)+3*Math.cos(a+2*e+2*d);g-=3*Math.cos(2*(a+e+h-d))-3*Math.cos(a+2*e+h-2*d)+3*Math.cos(a-2*h+2*d)+3*Math.cos(a+2*d)+3*Math.cos(a+2*e-f-2*d)+3*Math.cos(a-2*d)+3*Math.cos(a+2*e+2*h);return 1E-4/3600*g};b.toGasDegrees=function(c){c=c.daysSinceJ2000;var a=c/36525,d=a*a,e=d*a,f=b.calc_Moon_MeanElongation(a,d,e)*b.D2R,h=b.calc_Sun_MeanAnomaly(a,d,e)*b.D2R,k=b.calc_Moon_MeanAnomaly(a,d,e)*b.D2R,l=b.calc_Moon_ArgumentOfLatitude(a,d,e)*b.D2R,p=b.calc_Sun_LongitudeOfAscendingNode(a,
d,e)*b.D2R,n=b.calc_Ecliptic_NutationInLongitude(a,p,f,l,h,k),a=b.calc_Ecliptic_MeanObliquity(a,d,e)+b.calc_Ecliptic_MeanObliquityCorrection(a,d,e,p,f,l,h,k);c=280.46061837+360.98564736629*c+3.87933E-4*d-e/3871E4+n*Math.cos(a*b.D2R);return c=b.normalize(c)};b.correctForRefraction=function(c){c instanceof f.Angle&&(c=c.degrees);var a=1/Math.tan((c+7.31/(c+4.4))*b.D2R),a=a-.06*Math.sin((14.7*a/60+13)*b.D2R);return f.Angle.fromDegrees(c+a/60)};b.uncorrectRefraction=function(c){c instanceof f.Angle&&
(c=c.degrees);var a=1/Math.tan((c+7.31/(c+4.4))*b.D2R),a=a-.06*Math.sin((14.7*a/60+13)*b.D2R);return c-a/60};b.toTopocentric=function(c){c instanceof f.Angle&&(c=c.degrees);return b.correctForRefraction(c-Math.atan(Math.cos(c*b.D2R)/(1E10-Math.sin(c*b.D2R)))*b.R2D)};b.toGeocentric=function(c){c instanceof f.Angle&&(c=c.degrees);c=b.uncorrectRefraction(c);return f.Angle.fromDegrees(c+Math.atan(Math.cos(c*b.D2R)/(1E10-Math.sin(c*b.D2R)))*b.R2D)};b.toUnitVector=function(c){var a=c.declination.radians;
c=c.rightAscension.radians;var b=[];b.push(Math.cos(a)*Math.cos(c));b.push(Math.cos(a)*Math.sin(c));b.push(Math.sin(a));return b};b.fromUnitVector=function(c){var a=Math.asin(c[2]);return new r.EquatorialCoordinates(f.Angle.fromRadians(Math.atan2(c[1],c[0])),f.Angle.fromRadians(a))};b.precesionMatrixParams=function(c){var a=c.centuriesSinceJ2000,b=a*a,d=b*a;c=.011180860865024398*a+1.4635555405334672E-6*b+Math.pow(8.72567663260943,-8)*d;var e=.011180860865024398*a+5.307158404369869E-6*b+Math.pow(8.825063437236881,
-8)*d,a=.009717173455169672*a+2.068457570453835E-6*b+Math.pow(2.0281210721855225,-7)*d;return{p00:Math.cos(e)*Math.cos(a)*Math.cos(c)-Math.sin(e)*Math.sin(c),p01:-Math.cos(e)*Math.cos(a)*Math.sin(c)-Math.sin(e)*Math.cos(c),p02:-Math.cos(e)*Math.sin(a),p10:Math.sin(e)*Math.cos(a)*Math.cos(c)+Math.cos(e)*Math.sin(c),p11:-Math.sin(e)*Math.cos(a)*Math.sin(c)+Math.cos(e)*Math.cos(c),p12:-Math.sin(e)*Math.sin(a),p20:Math.sin(a)*Math.cos(c),p21:-Math.sin(a)*Math.sin(c),p22:Math.cos(a)}};b.determinant3x3=
function(c){return c[0][0]*c[1][1]*c[2][2]-c[0][0]*c[1][2]*c[2][1]-c[0][1]*c[1][0]*c[2][2]+c[0][1]*c[1][2]*c[2][0]+c[0][2]*c[1][0]*c[2][1]-c[0][2]*c[1][1]*c[2][0]};b.inverse3x3=function(c){var a=b.determinant3x3(c);return[[(c[1][1]*c[2][2]-c[1][2]*c[2][1])/a,(c[0][2]*c[2][1]-c[0][1]*c[2][2])/a,(c[0][1]*c[1][2]-c[0][2]*c[1][1])/a],[(c[1][2]*c[2][0]-c[1][0]*c[2][2])/a,(c[0][0]*c[2][2]-c[0][2]*c[2][0])/a,(c[0][2]*c[1][0]-c[0][0]*c[1][2])/a],[(c[1][0]*c[2][1]-c[1][1]*c[2][0])/a,(c[0][1]*c[2][0]-c[0][0]*
c[2][1])/a,(c[0][0]*c[1][1]-c[0][1]*c[1][0])/a]]};b.inversePrecesionMatrixAt=function(c){c=b.precesionMatrixParams(c);return[[c.p00,c.p10,c.p20],[c.p01,c.p11,c.p21],[c.p02,c.p12,c.p22]]};b.precesionMatrixAt=function(c){c=b.precesionMatrixParams(c);return[[c.p00,c.p01,c.p02],[c.p10,c.p11,c.p12],[c.p20,c.p21,c.p22]]};b.matrixTimesMatrix=function(c,a){return[[c[0][0]*a[0][0]+c[0][1]*a[1][0]+c[0][2]*a[2][0],c[0][0]*a[0][1]+c[0][1]*a[1][1]+c[0][2]*a[2][1],c[0][0]*a[0][2]+c[0][1]*a[1][2]+c[0][2]*a[2][2]],
[c[1][0]*a[0][0]+c[1][1]*a[1][0]+c[1][2]*a[2][0],c[1][0]*a[0][1]+c[1][1]*a[1][1]+c[1][2]*a[2][1],c[1][0]*a[0][2]+c[1][1]*a[1][2]+c[1][2]*a[2][2]],[c[2][0]*a[0][0]+c[2][1]*a[1][0]+c[2][2]*a[2][0],c[2][0]*a[0][1]+c[2][1]*a[1][1]+c[2][2]*a[2][1],c[2][0]*a[0][2]+c[2][1]*a[1][2]+c[2][2]*a[2][2]]]};b.matrixTimesVector=function(a,b){return[a[0][0]*b[0]+a[0][1]*b[1]+a[0][2]*b[2],a[1][0]*b[0]+a[1][1]*b[1]+a[1][2]*b[2],a[2][0]*b[0]+a[2][1]*b[1]+a[2][2]*b[2]]};b.fromJ2000=function(a,g){var d=b.toUnitVector(a),
e=b.precesionMatrixAt(g),d=b.matrixTimesVector(e,d);return b.fromUnitVector(d)};b.toJ2000=function(a,g){var d=b.toUnitVector(a),e=b.inversePrecesionMatrixAt(g),d=b.matrixTimesVector(e,d);return b.fromUnitVector(d)};b.toEpoch=function(a,g){var d=g.centuriesSinceJ2000,e=d*d,h=d*e,k;k=b.D2R/3600*(2306.2181*d+.30188*e+.017998*h);var l;l=b.D2R/3600*(2306.2181*d+1.09468*e+.018203*h);var h=b.D2R/3600*(2004.3109*d-.42665*e-.041833*h),p=a.rightAscension.radians,d=a.declination.radians,e=Math.cos(d)*Math.sin(p+
k);k=Math.cos(h)*Math.cos(d)*Math.cos(p+k)-Math.sin(h)*Math.sin(d);l=Math.atan2(e,k)+l;0>l?l+=b.PI2:l>b.PI2&&(l-=b.PI2);l*=b.R2D;k=Math.acos(Math.sqrt(e*e+k*k));0>k*d&&(k=-k);k*=b.R2D;return new r.EquatorialCoordinates(f.Angle.fromDegrees(l),f.Angle.fromDegrees(k))};b.calc_SunriseOrSunset_UTC=function(a,g,d,e){var f=g.centuriesSinceJ2000;g=b.calc_EquationOfTime(f);f=b.calc_Sun_Declination(f);a=b.calcHourAngleSunriseOrSunset(a,d.latitude.degrees,f,e);return 720-4*(d.longitude.degrees+b.R2D*a)-g};b.prepareJd=
function(a){if(a instanceof Date)a=h.UtcDate.fromDate(a);else if(!(a instanceof h.UtcDate))throw"date";return a};b.calc_SunriseOrSunset=function(a,g,d,e){var f=g.toDate();g=new h.UtcDate(h.UtcDate.toUtcDays(f.getFullYear(),f.getMonth(),f.getDate()));var k=-f.getTimezoneOffset()/60,f=b.isDaylightSavingsTime(f),l=d.latitude.degrees,p=d.longitude.degrees,n=b.calc_SunriseOrSunset_UTC(a,g,d,e);d=b.calc_SunriseOrSunset_UTC(a,g.addMinutes(n),d,e);if("number"==typeof d){a=d;if(0<=a&&1440>a)return g.addMinutes(a);
g=g.days;for(k=0>a?1:-1;0>a||1440<=a;)a+=1440*k,g-=k;return(new h.UtcDate(g)).addMinutes(a)}d=b.calcDoyFromJD(g.days);66.4<l&&79<d&&267>d||-66.4>l&&(83>d||263<d)?a?b.calc_JDofNextPrevRiseSet(0,a,g.days,l,p,k,f):b.calc_JDofNextPrevRiseSet(1,a,g.days,l,p,k,f):1==a?b.calc_JDofNextPrevRiseSet(1,a,g.days,l,p,k,f):b.calc_JDofNextPrevRiseSet(0,a,g.days,l,p,k,f);throw"notimplementedyet";};b.calc_JDofNextPrevRiseSet=function(a,g,d,e,f,h,k){a=a?1:-1;for(var l=b.calc_SunriseOrSunset_UTC(g,d,e,f);"number"!=typeof l;)d+=
a,l=b.calc_SunriseOrSunset_UTC(g,d,e,f);for(g=l+60*h+(k?60:0);0>g||1440<=g;)e=0>g?1:-1,g+=1440*e,d-=e;return d};b.isLeapYear=function(a){return 0==a%4&&0!=a%100||0==a%400};b.calcDoyFromJD=function(a){var d=Math.floor(a+.5);if(2299161>d)var e=d;else e=Math.floor((d-1867216.25)/36524.25),e=d+1+e-Math.floor(e/4);var f=e+1524,e=Math.floor((f-122.1)/365.25),h=Math.floor(365.25*e),k=Math.floor((f-h)/30.6001);a=f-h-Math.floor(30.6001*k)+(a+.5-d);d=14>k?k-1:k-13;e=b.isLeapYear(2<d?e-4716:e-4715)?1:2;return Math.floor(275*
d/9)-e*Math.floor((d+9)/12)+a-30};b.calcSunRa=function(a,d,e){d=d||b.calc_Ecliptic_ObliquityCorrection(a);a=e||b.calc_Sun_ApparentLong(a);return b.R2D*Math.atan2(Math.cos(b.D2R*d)*Math.sin(b.D2R*a),Math.cos(b.D2R*a))};b.calc_Sun_Declination=function(a,d,e){d=d||b.calc_Ecliptic_ObliquityCorrection(a);a=e||b.calc_Sun_ApparentLong(a);return b.R2D*Math.asin(Math.sin(b.D2R*d)*Math.sin(b.D2R*a))};b.calc_EquationOfTime=function(a,d,e,f,h){d=d||b.calc_Ecliptic_ObliquityCorrection(a);e=e||b.calc_Sun_MeanLongitude(a);
f=f||b.calc_Earth_OrbitEccentricity(a);a=h||b.calc_Sun_MeanAnomaly(a);h=Math.tan(b.D2R*d/2);h*=h;d=Math.sin(b.D2R*a);e=h*Math.sin(2*b.D2R*e)-2*f*d+4*f*h*d*Math.cos(2*b.D2R*e)-.5*h*h*Math.sin(4*b.D2R*e)-1.25*f*f*Math.sin(2*b.D2R*a);return e=b.R2D*e*4};b.getHRadians=function(a){var b=0;switch(a){case q.Astronomical:b=18;break;case q.Nautical:b=12;break;case q.Civil:b=6;break;case q.Official:b=.833;break;default:throw"twilight";}return b+90};b.calcHourAngleSunriseOrSunset=function(a,d,e,f){d*=b.D2R;
e*=b.D2R;f=b.getHRadians(f);f=Math.acos(Math.cos(b.D2R*f)/(Math.cos(d)*Math.cos(e))-Math.tan(d)*Math.tan(e));return a?f:-f};b.isDaylightSavingsTime=function(a){var b=new Date(a.getFullYear(),0,1),d=new Date(a.getFullYear(),6,1),b=Math.max(b.getTimezoneOffset(),d.getTimezoneOffset());return a.getTimezoneOffset()<b};b.calcAzEl=function(a,d,e,f,h){var k=b.calc_EquationOfTime(a),l=b.calc_Sun_Declination(a);f=k+4*f-60*h;b.calcSunRadVector(a);for(a=d+f;1440<a;)a-=1440;a=a/4-180;-180>a&&(a+=360);d=Math.sin(b.D2R*
e)*Math.sin(b.D2R*l)+Math.cos(b.D2R*e)*Math.cos(b.D2R*l)*Math.cos(b.D2R*a);1<d?d=1:-1>d&&(d=-1);d=b.R2D*Math.acos(d);f=Math.cos(b.D2R*e)*Math.sin(b.D2R*d);.001<Math.abs(f)?(e=(Math.sin(b.D2R*e)*Math.cos(b.D2R*d)-Math.sin(b.D2R*l))/f,1<Math.abs(e)&&(e=0>e?-1:1),e=180-b.R2D*Math.acos(e),0<a&&(e=-e)):e=0<e?180:0;0>e&&(e+=360);return e};b.PI=Math.PI;b.PI2=2*Math.PI;b.D2R=Math.PI/180;b.R2D=180/Math.PI;b.MinsPerAU=8.3168775;b.TaiToTtOffsetSeconds=32.184;b.LeapSeconds=[{utcdays:2457204.5,taiutc:{p1:36,p2:41317,
p3:0}},{utcdays:2456109.5,taiutc:{p1:35,p2:41317,p3:0}},{utcdays:2454832.5,taiutc:{p1:34,p2:41317,p3:0}},{utcdays:2453736.5,taiutc:{p1:33,p2:41317,p3:0}},{utcdays:2451179.5,taiutc:{p1:32,p2:41317,p3:0}},{utcdays:2450630.5,taiutc:{p1:31,p2:41317,p3:0}},{utcdays:2450083.5,taiutc:{p1:30,p2:41317,p3:0}},{utcdays:2449534.5,taiutc:{p1:29,p2:41317,p3:0}},{utcdays:2449169.5,taiutc:{p1:28,p2:41317,p3:0}},{utcdays:2448804.5,taiutc:{p1:27,p2:41317,p3:0}},{utcdays:2448257.5,taiutc:{p1:26,p2:41317,p3:0}},{utcdays:2447892.5,
taiutc:{p1:25,p2:41317,p3:0}},{utcdays:2447161.5,taiutc:{p1:24,p2:41317,p3:0}},{utcdays:2446247.5,taiutc:{p1:23,p2:41317,p3:0}},{utcdays:2445516.5,taiutc:{p1:22,p2:41317,p3:0}},{utcdays:2445151.5,taiutc:{p1:21,p2:41317,p3:0}},{utcdays:2444786.5,taiutc:{p1:20,p2:41317,p3:0}},{utcdays:2444239.5,taiutc:{p1:19,p2:41317,p3:0}},{utcdays:2443874.5,taiutc:{p1:18,p2:41317,p3:0}},{utcdays:2443509.5,taiutc:{p1:17,p2:41317,p3:0}},{utcdays:2443144.5,taiutc:{p1:16,p2:41317,p3:0}},{utcdays:2442778.5,taiutc:{p1:15,
p2:41317,p3:0}},{utcdays:2442413.5,taiutc:{p1:14,p2:41317,p3:0}},{utcdays:2442048.5,taiutc:{p1:13,p2:41317,p3:0}},{utcdays:2441683.5,taiutc:{p1:12,p2:41317,p3:0}},{utcdays:2441499.5,taiutc:{p1:11,p2:41317,p3:0}},{utcdays:2441317.5,taiutc:{p1:10,p2:41317,p3:0}},{utcdays:2439887.5,taiutc:{p1:4.21317,p2:39126,p3:.002592}},{utcdays:2439126.5,taiutc:{p1:4.31317,p2:39126,p3:.002592}},{utcdays:2439004.5,taiutc:{p1:3.84013,p2:38761,p3:.001296}},{utcdays:2438942.5,taiutc:{p1:3.74013,p2:38761,p3:.001296}},
{utcdays:2438820.5,taiutc:{p1:3.64013,p2:38761,p3:.001296}},{utcdays:2438761.5,taiutc:{p1:3.54013,p2:38761,p3:.001296}},{utcdays:2438639.5,taiutc:{p1:3.44013,p2:38761,p3:.001296}},{utcdays:2438486.5,taiutc:{p1:3.34013,p2:38761,p3:.001296}},{utcdays:2438395.5,taiutc:{p1:3.24013,p2:38761,p3:.001296}},{utcdays:2438334.5,taiutc:{p1:1.945858,p2:37665,p3:.0011232}},{utcdays:2437665.5,taiutc:{p1:1.845858,p2:37665,p3:.0011232}},{utcdays:2437512.5,taiutc:{p1:1.372818,p2:37300,p3:.001296}},{utcdays:2437300.5,
taiutc:{p1:1.422818,p2:37300,p3:.001296}}];return b}();l.MeeusEngine=k},{"../angle":1,"../coordinateSystems/equatorialCoordinates":3,"../coordinateSystems/geographicCoordinates":4,"../coordinateSystems/horizontalCoordinates":5,"../datetime/hjddate":7,"../datetime/siderealtimes":8,"../datetime/taidate":9,"../datetime/ttdate":10,"../datetime/utcdate":11}],7:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});f.prototype.addDays=function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=function(h){return new f(this.days+
h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.HjdDate=k},{}],8:[function(k,n,l){var f=this&&this.__extends||function(e,a){function d(){this.constructor=e}for(var f in a)a.hasOwnProperty(f)&&(e[f]=a[f]);e.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)},h=k("./utcdate");k=function(){function e(a){this._hours=a}Object.defineProperty(e.prototype,"hours",{get:function(){return this._hours},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"hour",{get:function(){return 0|this._hours},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"minutes",{get:function(){return 60*(this.hours-this.hour)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"minute",{get:function(){return 0|this.minutes},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"seconds",{get:function(){return 60*(this.minutes-this.minute)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"second",{get:function(){return 0|
this.seconds},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"milliseconds",{get:function(){return 1E3*(this.seconds-this.second)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"millisecond",{get:function(){return 0|this.milliseconds},enumerable:!0,configurable:!0});e.prototype.toFormattedString=function(){var a=Math.round(this.seconds),d=Math.round(this.minute),f=this.hour;60==a&&(d+=1,a=0);60<=d&&(f+=1,d-=60);return f+":"+e.absPad(d)+":"+e.absPad(a)};e.absPad=
function(a,d){var e=Math.abs(a).toFixed(d||0),f=parseFloat(e);return(10>f&&-10<f?"0":"")+e};return e}();l.__BaseTime=k;n=function(e){function a(){e.apply(this,arguments)}f(a,e);a.fromDate=function(a){return h.UtcDate.fromDate(a).toGmsTime()};return a}(k);l.GmsTime=n;n=function(e){function a(){e.apply(this,arguments)}f(a,e);return a}(k);l.LmsTime=n;n=function(e){function a(){e.apply(this,arguments)}f(a,e);a.fromDate=function(a){return h.UtcDate.fromDate(a).toGasTime()};return a}(k);l.GasTime=n;k=function(e){function a(){e.apply(this,
arguments)}f(a,e);return a}(k);l.LasTime=k},{"./utcdate":11}],9:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});f.prototype.addDays=
function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=function(h){return new f(this.days+h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.TaiDate=k},{}],10:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});f.prototype.addDays=function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=function(h){return new f(this.days+
h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.TtDate=k},{}],11:[function(k,n,l){var f=k("../core/meeusEngine");k=function(){function h(e){this._days=void 0===e?h.getJulianDays(new Date):e}Object.defineProperty(h.prototype,"days",{get:function(){return this._days},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});Object.defineProperty(h,"J2000",{get:function(){return new h(2451545)},enumerable:!0,configurable:!0});Object.defineProperty(h,"B1950",{get:function(){return new h(2433282.4229166666)},enumerable:!0,configurable:!0});h.prototype.addDays=function(e){return new h(this.days+e)};h.prototype.addHours=function(e){return new h(this.days+e/24)};h.prototype.addMinutes=function(e){return new h(this.days+
e/1440)};h.prototype.addSeconds=function(e){return new h(this.days+e/86400)};h.prototype.addMilliseconds=function(e){return new h(this.days+e/864E5)};h.prototype.toDate=function(){var e,a,d,f,h,k;k=this.days+.5;e=Math.floor(k);2299161>e?a=e:(a=Math.floor((e-1867216.25)/36524.25),a=e+1+a-Math.floor(a/4));d=a+1524;a=Math.floor((d-122.1)/365.25);f=Math.floor(365.25*a);h=Math.floor((d-f)/30.6);k=d-f-Math.floor(30.6001*h)+(k-e);e=13<h?0|h-13:0|h-1;h=24*(k-(0|k));a=new Date(1==e||2==e?0|a-4715:0|a-4716,
e-1,0|k);return new Date(a.getTime()+6E4*(60*h-a.getTimezoneOffset()))};h.prototype.toLmsTime=function(e){return f.MeeusEngine.toLmsTime(this,e)};h.prototype.toGmsTime=function(){return f.MeeusEngine.toGmsTime(this)};h.prototype.toLasTime=function(e){return f.MeeusEngine.toLasTime(this,e)};h.prototype.toGasTime=function(){return f.MeeusEngine.toGasTime(this)};h.prototype.toTaiDate=function(){return f.MeeusEngine.toTaiDate(this)};h.prototype.toTtDate=function(){return f.MeeusEngine.toTtDate(this)};
h.prototype.toHjdDate=function(e,a){return f.MeeusEngine.toHjdDate(this,e,a)};h.fromDate=function(e){return new h(h.getJulianDays(e))};h.fromJ2000Centuries=function(e){return new h(36525*e+2451545)};h.isJulianCalendar=function(e,a,d){if(1582>e)return!0;if(1582<e)return!1;if(10>a)return!0;if(10<a)return!1;if(5>d)return!0;if(14<d)return!1;throw"This date is not valid as it does not exist in either the Julian or the Gregorian calendars.";};h.getJulianDays=function(e){var a=e.getUTCFullYear(),d=e.getUTCMonth(),
f=e.getUTCDate(),k=e.getUTCHours(),l=e.getUTCMinutes(),n=e.getUTCSeconds();e=e.getUTCMilliseconds();return h.toUtcDays(a,d,f,k,l,n,e)};h.toUtcDays=function(e,a,d,f,k,l,n){a+=1;f=f||0;k=k||0;l=l||0;n=n||0;var q=h.isJulianCalendar(e,a,d);e=2<a?e:e-1;var b=Math.floor(e/100);return(q?0:2-b+Math.floor(b/4))+Math.floor(365.25*(e+4716))+Math.floor(30.6001*((2<a?a:a+12)+1))-1524.5+d+f/24+k/1440+(l+n/1E3)/86400};return h}();l.UtcDate=k},{"../core/meeusEngine":6}],12:[function(k,n,l){function f(f){for(var e in f)l.hasOwnProperty(e)||
(l[e]=f[e])}f(k("./angle"));f(k("./solarSystem/moon"));f(k("./solarSystem/earth"));f(k("./solarSystem/sun"));f(k("./datetime/hjddate"));f(k("./datetime/siderealtimes"));f(k("./datetime/taidate"));f(k("./datetime/ttdate"));f(k("./datetime/utcdate"));f(k("./coordinateSystems/eclipticalCoordinates"));f(k("./coordinateSystems/equatorialCoordinates"));f(k("./coordinateSystems/geographicCoordinates"));f(k("./coordinateSystems/horizontalCoordinates"));f(k("./core/meeusEngine"))},{"./angle":1,"./coordinateSystems/eclipticalCoordinates":2,
"./coordinateSystems/equatorialCoordinates":3,"./coordinateSystems/geographicCoordinates":4,"./coordinateSystems/horizontalCoordinates":5,"./core/meeusEngine":6,"./datetime/hjddate":7,"./datetime/siderealtimes":8,"./datetime/taidate":9,"./datetime/ttdate":10,"./datetime/utcdate":11,"./solarSystem/earth":13,"./solarSystem/moon":14,"./solarSystem/sun":15}],13:[function(k,n,l){var f=k("../core/meeusEngine"),h=k("../datetime/utcdate");k=function(){function e(){}e.orbitalEccentricity=function(a){var d=
a;d instanceof Date&&(d=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianPositionAt(d)};e.cartesianPositionAt=function(a){var d=a;d instanceof Date&&(d=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianPositionAt(d)};e.cartesianVelocityAt=function(a){var d=a;d instanceof Date&&(d=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianVelocityAt(d)};return e}();l.Earth=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}],14:[function(k,n,l){var f=k("../datetime/utcdate"),h=k("../core/meeusEngine");
k=function(){function e(){}e.positionAt=function(a){var d=a;d instanceof Date&&(d=f.UtcDate.fromDate(a));return h.MeeusEngine.moonPositionAt(d)};e.terminatorLongitudeAt=function(a){var d=a;d instanceof Date&&(d=f.UtcDate.fromDate(a));return h.MeeusEngine.calc_Moon_LongitudeOfTerminator(d)};e.illuminatedDiscFractionAt=function(a){var d=a;d instanceof Date&&(d=f.UtcDate.fromDate(a));return h.MeeusEngine.calc_Moon_IlluminatedDiscFraction(d)};return e}();l.Moon=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}],
15:[function(k,n,l){var f=k("../datetime/utcdate"),h=k("../core/meeusEngine");k=function(){function e(){}e.positionAt=function(a){var d=a;d instanceof Date&&(d=f.UtcDate.fromDate(a));return h.MeeusEngine.sunPositionAt(d)};return e}();l.Sun=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}]},{},[12])(12)});

