/**
  @license
  Dual-licensed: https://github.com/sybilla/meeus/blob/master/LICENSE.txt
 **/
(function(k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define([],k):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).meeus=k()})(function(){return function(){function k(n,l,f){function h(e,a){if(!l[e]){if(!n[e]){var p="function"==typeof require&&require;if(!a&&p)return p(e,!0);if(c)return c(e,!0);p=Error("Cannot find module '"+e+"'");throw p.code="MODULE_NOT_FOUND",p;}p=
l[e]={exports:{}};n[e][0].call(p.exports,function(a){return h(n[e][1][a]||a)},p,p.exports,k,n,l,f)}return l[e].exports}for(var c="function"==typeof require&&require,a=0;a<f.length;a++)h(f[a]);return h}return k}()({1:[function(k,n,l){(function(e){e[e.Hour=0]="Hour";e[e.Degree=1]="Degree";e[e.Radian=2]="Radian"})(l.AngleStyle||(l.AngleStyle={}));var f=l.AngleStyle;(function(e){e[e.Reflective=0]="Reflective";e[e.Periodic=1]="Periodic"})(l.AngleNormalization||(l.AngleNormalization={}));var h=l.AngleNormalization,
c=function(){function e(){}e.parse=function(a,c,f){return e.matchToAngle(e.match(a,c,f))};e.match=function(a,c,f){null!=a&&(a=a.trim().replace(/^[^(0-9|a-zA-Z|\-)]/,""));for(var h=null,k=0;k<e.RegexPatterns.length;k++){var b=(new RegExp(e.RegexPatterns[k],"g")).exec(a);if(null!=b){void 0===f&&(a=c[k],f=void 0!==a?a:e.RegexPatternStyleMap[k]);h={match:b,style:f};break}}if(null==h)throw"s";return h};e.matchToAngle=function(e){var c=e.match[2];c&&(c=c.replace(",","."));var h=parseFloat(c);isNaN(h)&&
(h=0);(c=e.match[4])&&(c=c.replace(",","."));var k=parseFloat(c);isNaN(k)&&(k=0);(c=e.match[6])&&(c=c.replace(",","."));c=parseFloat(c);isNaN(c)&&(c=0);switch(e.style){case f.Hour:h=a.fromHours(h,k,c);break;case f.Degree:h=a.fromDegrees(h,k,c);break;case f.Radian:h=a.fromRadians(h);break;default:throw"style";}"-"===e.match[1]&&(h=h.negative());return h};e.RegexPatterns="^d ([+-])?(\\d{1,3}):( )?(\\d{1,2}):( )?(\\d{1,2}([\\.,]\\d+)?);^([+-])?(\\d{1,3}):( )?(\\d{1,2}):( )?(\\d{1,2}([\\.,]\\d+)?);^d ([+-])?(\\d{1,3})() (\\d{1,2})() (\\d{1,2}([\\.,]\\d+)?);^([+-])?(\\d{1,3})() (\\d{1,2})() (\\d{1,2}([\\.,]\\d+)?);^([+-])?(\\d{1,3})h( )?(\\d{1,2})m( )?(\\d{1,2}([\\.,]\\d+)?)[s]?;^([+-])?(\\d{1,3})d( )?(\\d{1,2})m( )?(\\d{1,2}([\\.,]\\d+)?)[s]?;^([+-])?(\\d{1,3})[\u00b0*]( )?(\\d{1,2})'( )?(\\d{1,2}([\\.,]\\d+)?)[\"]?;^([a-zA-Z])(\\d{2})()(\\d{2})()(\\d{2}([\\.,]\\d+)?);^([+-])?(\\d{2})()(\\d{2}[\\.,]\\d+);^([+-])?(\\d{2})()(\\d{2})()(\\d{2}([\\.,]\\d+)?);^[d][ ]([+-])?(\\d{1,3}([\\.\\,]\\d+)?);^([+-])?(\\d{1,3}([\\.,]\\d+)?)".split(";");
e.RegexPatternStyleMap={0:f.Degree,1:f.Degree,2:f.Degree,3:f.Degree,4:f.Hour,5:f.Degree,6:f.Degree,7:f.Hour,8:f.Degree,9:f.Degree,10:f.Degree,11:f.Radian};return e}();l.AngleParser=c;var a=function(){function e(a){this._dms=a*e.DegreeMillisecondsInDegree}Object.defineProperty(e.prototype,"hours",{get:function(){return this._dms/(e.DegreeMillisecondsInMillisecond*e.DegreeMillisecondsInDegree)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hour",{get:function(){return 0|this.hours},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourMinutes",{get:function(){return(0|this._dms/e.DegreeMillisecondsInMillisecond)%e.DegreeMillisecondsInDegree/e.DegreeMillisecondsInDegreeMinute},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourMinute",{get:function(){return 0|this.hourMinutes},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourSeconds",{get:function(){return(0|this._dms/e.DegreeMillisecondsInMillisecond)%e.DegreeMillisecondsInDegreeMinute/
e.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourSecond",{get:function(){return 0|this.hourSeconds},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourMilliseconds",{get:function(){return(0|this._dms/e.DegreeMillisecondsInMillisecond)%e.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hourMillisecond",{get:function(){return 0|this.hourMilliseconds},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"degrees",{get:function(){return this._dms/e.DegreeMillisecondsInDegree},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degree",{get:function(){return 0|this.degrees},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degreeMinutes",{get:function(){return(0|this._dms)%e.DegreeMillisecondsInDegree/e.DegreeMillisecondsInDegreeMinute},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degreeMinute",{get:function(){return 0|
this.degreeMinutes},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degreeSeconds",{get:function(){return(0|this._dms)%e.DegreeMillisecondsInDegreeMinute/e.DegreeMillisecondsInDegreeSecond},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degreeSecond",{get:function(){return 0|this.degreeSeconds},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"degreeMilliseconds",{get:function(){return this._dms},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"degreeMillisecond",{get:function(){return 0|this.degreeMilliseconds},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"radians",{get:function(){return this.degrees*Math.PI/180},enumerable:!0,configurable:!0});e.prototype.addHours=function(a){return e.fromHours(this.hours+a)};e.prototype.addHourMinutes=function(a){return e.fromHours(this.hours,a)};e.prototype.addHourSeconds=function(a){return e.fromHours(this.hours,0,a)};e.prototype.addHourMilliseconds=function(a){return e.fromHours(this.hours,
0,0,a)};e.prototype.addDegrees=function(a){return e.fromDegrees(this.degrees+a)};e.prototype.addDegreeMinutes=function(a){return e.fromDegrees(this.degrees,a)};e.prototype.addDegreeSeconds=function(a){return e.fromDegrees(this.degrees,0,a)};e.prototype.addDegreeMilliseconds=function(a){return e.fromDegrees(this.degrees,0,0,a)};e.prototype.toFormattedString=function(a){a=a||{};var c=1,f="D",h=typeof a;"string"===h?f=a:"number"===h?c=a:(a.format=a.format||f,a.digits=null!=a.digits?a.digits:c,f=a.format,
c=a.digits);switch(f){case "H":return h=this.hourSeconds,a=this.hourMinute,f=this.hour,h=e.absPad(h,c),h=parseFloat(h),60<=h&&(h-=60,a+=1),60<=a&&(a-=60,f+=1),24<=f&&(f-=24),f+"h"+e.absPad(a)+"m"+e.absPad(h,c)+"s";case "D":a=0>this._dms?"-":"";var k=this.degreeSeconds,f=this.degreeMinute,h=this.degree,k=e.absPad(k,c),k=parseFloat(k);60<=k&&(k-=60,f+=1);60<=f&&(f-=60,h+=1);360<=h&&(h-=360);return a+Math.abs(h)+"\u00b0"+e.absPad(f)+"'"+e.absPad(k,c)+'"';case "R":return this.radians.toFixed(2).toString();
default:return""}};e.prototype.negative=function(){return e.fromDegrees(0,0,0,-this._dms)};e.prototype.normalize=function(a,e){a=a||0;e=void 0===e?h.Periodic:e;switch(e){case h.Reflective:return this.__normalizeReflective(a);case h.Periodic:return this.__normalizePeriodic(a);default:throw"normalization";}};e.prototype.__normalizeReflective=function(a){var c=a+180,f=this.__normalizeInternal(a-90);f<a?f=a+Math.min(Math.abs(f-a),Math.abs(f+a)):f>=c&&(f=c-Math.min(Math.abs(f-c),Math.abs(f+c)));return e.fromDegrees(f)};
e.prototype.__normalizePeriodic=function(a){return e.fromDegrees(this.__normalizeInternal(a))};e.prototype.__normalizeInternal=function(a){var e=this.degrees;a=(e-a)/360;0>a&&--a;return e-360*(0|a)};e.fromDegrees=function(a,c,f,h){a=(a||0)+(c||0)/60+(f||0)/3600+(h||0)/36E5;360<=Math.abs(a)&&(c=Math.floor(a),a-=c,a=c%360+a);return new e(a)};e.fromHours=function(a,c,f,h){a=(a||0)+(c||0)/60+(f||0)/3600+(h||0)/36E5;24<=Math.abs(a)&&(c=Math.floor(a),a-=c,a=c%24+a);return new e(a*e.DegreeMillisecondsInMillisecond)};
e.fromRadians=function(a){return e.fromDegrees(180*(a||0)/Math.PI)};e.parse=function(a,e){return c.parse(a,c.RegexPatternStyleMap,e)};e.absPad=function(a,e){e=e||0;var c=(10>a&&-10<a?"0":"")+(0<e?Math.abs(a).toFixed(e+1):Math.abs(a).toFixed(e));0<e&&(c=c.substr(0,e+3));return c};e.DegreeMillisecondsInDegree=36E5;e.DegreeMillisecondsInDegreeMinute=6E4;e.DegreeMillisecondsInDegreeSecond=1E3;e.DegreeMillisecondsInMillisecond=15;return e}();l.Angle=a},{}],2:[function(k,n,l){var f=k("../angle");k=function(){function h(c,
a){this.latitude=c;this.longitude=a}Object.defineProperty(h.prototype,"latitude",{get:function(){return this._lat},set:function(c){this._lat=c.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"longitude",{get:function(){return this._lon},set:function(c){this._lon=c.normalize(-180)},enumerable:!0,configurable:!0});h.prototype.toFormattedString=function(c){c=c||{};null==c.digits&&(c.digits=1);return this.latitude.toFormattedString({format:"D",
digits:c.digits})+" "+this.longitude.toFormattedString({format:"D",digits:c.digits})};h.parse=function(c,a,e){a=f.AngleParser.match(c,h.RegexPatternStyleMap,a);if(!a.match)throw"s";var k=f.AngleParser.matchToAngle(a);c=c.substr(c.indexOf(a.match[0])+a.match[0].length);a=f.AngleParser.match(c,h.RegexPatternStyleMap,e);if(!a.match)throw"s";e=f.AngleParser.matchToAngle(a);c.substr(c.indexOf(a.match[0])+a.match[0].length).trim();return new h(k,e)};h.RegexPatternStyleMap={7:f.AngleStyle.Degree,11:f.AngleStyle.Degree};
return h}();l.EclipticCoordinates=k},{"../angle":1}],3:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function c(a,e){this.rightAscension=a;this.declination=e}Object.defineProperty(c.prototype,"rightAscension",{get:function(){return this._ra},set:function(a){this._ra=a.normalize()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"declination",{get:function(){return this._dec},set:function(a){this._dec=a.normalize(-90,f.AngleNormalization.Reflective)},
enumerable:!0,configurable:!0});c.prototype.toHorizontalCoordinates=function(a,e){return h.MeeusEngine.toHorizontalCoordinates(this,a,e)};c.prototype.toFormattedString=function(a){a=a||{};null==a.digits&&(a.digits=1);return this.rightAscension.toFormattedString({format:"H",digits:a.digits})+" "+this.declination.toFormattedString({format:"D",digits:a.digits})};c.parse=function(a,e,h){var k=f.AngleParser.match(a,c.RaPatternStyleMap,e);if(!k.match)throw"s";e=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+
k.match[0].length);k=f.AngleParser.match(a,c.DecPatternStyleMap,h);if(!k.match)throw"s";a=f.AngleParser.matchToAngle(k);return new c(e,a)};c.RaPatternStyleMap={1:f.AngleStyle.Hour,3:f.AngleStyle.Hour,8:f.AngleStyle.Hour,9:f.AngleStyle.Hour,11:f.AngleStyle.Hour};c.DecPatternStyleMap={7:f.AngleStyle.Degree,11:f.AngleStyle.Degree};return c}();l.EquatorialCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],4:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function c(a,
e,c){this.latitude=a;this.longitude=e;this._alt=c||0}Object.defineProperty(c.prototype,"latitude",{get:function(){return this._lat},set:function(a){this._lat=a.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"longitude",{get:function(){return this._lon},set:function(a){this._lon=a.normalize(-180)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"altitude",{get:function(){return this._alt},enumerable:!0,configurable:!0});
c.prototype.sunrise=function(a,e){return h.MeeusEngine.getSunriseAt(this,a,e)};c.prototype.sunset=function(a,e){return h.MeeusEngine.getSunsetAt(this,a,e)};c.prototype.toFormattedString=function(a){a=a||{};null==a.digits&&(a.digits=1);return this.latitude.toFormattedString({format:"D",digits:a.digits})+" "+this.longitude.toFormattedString({format:"D",digits:a.digits})+" "+this.altitude};c.parse=function(a,e,h){var k=f.AngleParser.match(a,c.RegexPatternStyleMap,e);if(!k.match)throw"s";e=f.AngleParser.matchToAngle(k);
a=a.substr(a.indexOf(k.match[0])+k.match[0].length);k=f.AngleParser.match(a,c.RegexPatternStyleMap,h);if(!k.match)throw"s";h=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+k.match[0].length).trim();a=parseFloat(a);isNaN(a)&&(a=0);return new c(e,h,a)};c.RegexPatternStyleMap={7:f.AngleStyle.Degree,11:f.AngleStyle.Degree};return c}();l.GeographicCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],5:[function(k,n,l){var f=k("../angle"),h=k("../core/meeusEngine");k=function(){function c(a,
e){this.altitude=a;this.azimuth=e}Object.defineProperty(c.prototype,"altitude",{get:function(){return this._alt},set:function(a){this._alt=a.normalize(-90,f.AngleNormalization.Reflective)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"azimuth",{get:function(){return this._az},set:function(a){this._az=a.normalize()},enumerable:!0,configurable:!0});c.prototype.toEquatorialCoordinates=function(a,e){return h.MeeusEngine.toEquatorialCoordinates(this,a,e)};c.prototype.toFormattedString=
function(a){a=a||{};null==a.digits&&(a.digits=1);return this.altitude.toFormattedString({format:"D",digits:a.digits})+" "+this.azimuth.toFormattedString({format:"D",digits:a.digits})};c.parse=function(a,e,h){var k=f.AngleParser.match(a,c.RegexPatternStyleMap,e);if(!k.match)throw"s";e=f.AngleParser.matchToAngle(k);a=a.substr(a.indexOf(k.match[0])+k.match[0].length);k=f.AngleParser.match(a,c.RegexPatternStyleMap,h);if(!k.match)throw"s";a=f.AngleParser.matchToAngle(k);return new c(e,a)};c.RegexPatternStyleMap=
{7:f.AngleStyle.Degree,11:f.AngleStyle.Degree};return c}();l.HorizontalCoordinates=k},{"../angle":1,"../core/meeusEngine":6}],6:[function(k,n,l){var f=k("../angle"),h=k("../datetime/utcdate"),c=k("../datetime/hjddate"),a=k("../datetime/ttdate"),e=k("../datetime/siderealtimes"),t=k("../datetime/taidate"),p=k("../coordinateSystems/geographicCoordinates"),r=k("../coordinateSystems/equatorialCoordinates"),u=k("../coordinateSystems/horizontalCoordinates");(function(b){b[b.Official=0]="Official";b[b.Astronomical=
1]="Astronomical";b[b.Nautical=2]="Nautical";b[b.Civil=3]="Civil"})(l.Twilight||(l.Twilight={}));var q=l.Twilight;k=function(){function b(){}b.getLeapSeconds=function(d){for(var g=null,m=0;m<b.LeapSeconds.length;m++){var a=b.LeapSeconds[m];if(a.utcdays<d){g=a.taiutc;break}}if(null==g)throw"days";return g.p1+(d-2400000.5-g.p2)*g.p3};b.toTaiDate=function(d){var g=b.getLeapSeconds(d.days);return new t.TaiDate(d.days+g/86400)};b.toTtDate=function(d){var g=b.getLeapSeconds(d.days)+b.TaiToTtOffsetSeconds;
return new a.TtDate(d.days+g/86400)};b.toGmsTime=function(d){d=d.daysSinceJ2000;var g=d/36525,m=g*g;return new e.GmsTime(b.normalize(280.46061837+360.98564736629*d+3.87933E-4*m-m*g/3871E4)/15)};b.toLmsTime=function(d,g){var m=g;m instanceof f.Angle?m=m.degrees:m instanceof p.GeographicCoordinates&&(m=m.longitude.degrees);var a=d.daysSinceJ2000,c=a/36525,h=c*c;return new e.LmsTime(b.normalize(280.46061837+360.98564736629*a+3.87933E-4*h-h*c/3871E4+m)/15)};b.toGasTime=function(d){return new e.GasTime(b.toGasDegrees(d)/
15)};b.toLasTime=function(d,g){var m=g;m instanceof f.Angle?m=m.degrees:m instanceof p.GeographicCoordinates&&(m=m.longitude.degrees);var a=b.toGasDegrees(d);return new e.LasTime(b.normalize(a+m)/15)};b.toHjdDate=function(d,g,m){g=b.earthPositionAt(d);g=b.equatorialToCartesian(g);m=b.equatorialToCartesian(m);m=b.MinsPerAU*(g.x*m.x+g.y*m.y+g.z*m.z);return(new c.HjdDate(d.days)).addMinutes(m)};b.getSunriseAt=function(d,g,m){return b.calc_SunriseOrSunset(!0,b.prepareJd(g||new Date),d,m||q.Official)};
b.getSunsetAt=function(d,g,m){return b.calc_SunriseOrSunset(!1,b.prepareJd(g||new Date),d,m||q.Official)};b.sunPositionAt=function(d){var g=b.preparePositionalParameters(d.centuriesSinceJ2000);d=g.sun.trueLongitude;var m=g.ecliptic.meanObliquity,g=b.datan2(b.dsin(d)*b.dcos(m)-b.dtan(0)*b.dsin(m),b.dcos(d));d=b.dasin(b.dsin(0)*b.dcos(m)+b.dcos(0)*b.dsin(m)*b.dsin(d));return new r.EquatorialCoordinates(f.Angle.fromDegrees(g),f.Angle.fromDegrees(d))};b.earthPositionAt=function(d){var g=b.preparePositionalParameters(d.centuriesSinceJ2000);
d=g.sun.trueLongitude;var m=g.ecliptic.meanObliquity,g=b.datan2(b.dsin(d)*b.dcos(m)-b.dtan(0)*b.dsin(m),b.dcos(d));d=b.dasin(b.dsin(0)*b.dcos(m)+b.dcos(0)*b.dsin(m)*b.dsin(d));g+=180;360<g&&(g-=360);d*=-1;return new r.EquatorialCoordinates(f.Angle.fromDegrees(g),f.Angle.fromDegrees(d))};b.moonPositionAt=function(d){var g=d.centuriesSinceJ2000,m=g*g,a=m*g;d=b.preparePositionalParameters(g);var e=d.sun.earthDistance,c=d.sun.meanAnomaly;d=d.ecliptic.meanObliquity;var h=b.calc_Moon_ArgumentOfLatitude(g,
m,a),k=b.calc_Moon_MeanLongitude(g);b.calc_Moon_LongitudeAscendingNode(g,m,a);var l=b.calc_Moon_MeanAnomaly(g,m,a),g=b.calc_Moon_MeanElongation(g,m,a),m=b.calc_Moon_Earth_Distance(l,g);b.calc_Moon_Sun_DistanceRatio(m,e);e=b.calc_Moon_GeocentricLatitude(h,l,g);h=b.calc_Moon_GeocentricLongitude(l,g,k,h,c);c=b.datan2(b.dsin(h)*b.dcos(d)-b.dtan(e)*b.dsin(d),b.dcos(h));d=b.dasin(b.dsin(e)*b.dcos(d)+b.dcos(e)*b.dsin(d)*b.dsin(h));return new r.EquatorialCoordinates(f.Angle.fromDegrees(c),f.Angle.fromDegrees(d))};
b.getAngularSeparation=function(d,g){var m=d.rightAscension.radians,a=d.declination.radians,e=g.rightAscension.radians,c=g.declination.radians;return f.Angle.fromDegrees(Math.atan2(Math.sqrt(Math.cos(c)*Math.sin(m-e)*Math.cos(c)*Math.sin(m-e)+(Math.cos(a)*Math.sin(c)-Math.cos(c)*Math.sin(a)*Math.cos(m-e))*(Math.cos(a)*Math.sin(c)-Math.cos(c)*Math.sin(a)*Math.cos(m-e))),Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(m-e))*b.R2D)};b.toHorizontalCoordinates=function(d,g,m){var a;g instanceof
Date?a=h.UtcDate.fromDate(g):g instanceof h.UtcDate&&(a=g);d=b.fromJ2000(d,a);a=b.toLasTime(a,m.longitude.degrees);a=f.Angle.fromHours(a.hours-d.rightAscension.hours).normalize().radians;d=d.declination.radians;g=m.latitude.radians;var e=Math.asin(Math.sin(d)*Math.sin(g)+Math.cos(d)*Math.cos(g)*Math.cos(a));m=e*b.R2D;d=Math.acos((Math.sin(d)-Math.sin(e)*Math.sin(g))/(Math.cos(e)*Math.cos(g)))*b.R2D;0<Math.sin(a)&&(d=360-d);return new u.HorizontalCoordinates(b.toTopocentric(m),f.Angle.fromDegrees(d))};
b.toEquatorialCoordinates=function(d,g,m){var a;g instanceof Date?a=h.UtcDate.fromDate(g):g instanceof h.UtcDate&&(a=g);g=d.azimuth.degrees+180;360<=g&&(g-=360);g*=b.D2R;var e=m.latitude.radians;d=b.toGeocentric(d.altitude).radians;var c=f.Angle.fromRadians(Math.atan2(Math.sin(g),Math.cos(g)*Math.sin(e)+Math.tan(d)*Math.cos(e)));m=a.toLasTime(m.longitude.degrees);m=f.Angle.fromHours(m.hours-c.hours).normalize();g=Math.sin(e)*Math.sin(d)-Math.cos(e)*Math.cos(d)*Math.cos(g);if(-1>g||1<g)throw"Illegal value: "+
g+", should be in [-1,1].";return b.toJ2000(new r.EquatorialCoordinates(m,f.Angle.fromRadians(Math.asin(g))),a)};b.dsin=function(d){return Math.sin(b.D2R*d)};b.dcos=function(d){return Math.cos(b.D2R*d)};b.dtan=function(d){return Math.tan(b.D2R*d)};b.dasin=function(d){return b.R2D*Math.asin(d)};b.dacos=function(d){return b.R2D*Math.acos(d)};b.datan=function(d){return b.R2D*Math.atan(d)};b.datan2=function(d,g){var a;if(0==g&&0==d)return 0;a=b.datan(d/g);0>g&&(a+=180);0>d&&0<g&&(a+=360);return a};b.normalize=
function(d){return d-360*Math.floor(d/360)};b.addCartesian=function(d,g){return{x:d.x+g.x,y:d.y+g.y,z:d.z+g.z}};b.equatorialToCartesian=function(d){var g=d.rightAscension.radians;d=d.declination.radians;var b=Math.cos(d);return{x:Math.cos(g)*b,y:Math.sin(g)*b,z:Math.sin(d)}};b.geographicToCartesian=function(d,g){var b=g.toGasTime(),a=.017453292519943295*d.latitude.degrees,e=Math.sin(a),a=Math.cos(a),c=1/Math.sqrt(Math.pow(a,2)+.9933056213348961*Math.pow(e,2)),f=d.altitude/1E3,h=6378.14*c+f,b=.017453292519943295*
(15*b.hours+d.longitude.degrees);return{x:h*a*Math.cos(b)/149597870,y:h*a*Math.sin(b)/149597870,z:(6335.442315660955*c+f)*e/149597870}};b.preparePositionalParameters=function(d){var g=b.calc_Sun_MeanLongitude(d),a=b.calc_Sun_MeanAnomaly(d),e=b.calc_Sun_EqOfCenter(d,a),c=b.calc_Sun_TrueAnomaly(d,a,e),f=b.calc_Earth_OrbitEccentricity(d),g=b.calc_Sun_TrueLong(d,g,e),h=b.calc_Sun_LongitudeOfAscendingNode(d),h=b.calc_Sun_ApparentLong(d,g,h),k=b.calc_Ecliptic_MeanObliquity(d);d=b.calc_Sun_Earth_Distance(d,
f,a,e,c);return{sun:{trueLongitude:g,apparentLongitude:h,earthDistance:d,meanAnomaly:a},ecliptic:{meanObliquity:k}}};b.calc_Earth_OrbitEccentricity=function(d){return.016708634-d*(4.2037E-5+1.267E-7*d)};b.earthCartesianPositionAt=function(d){d=b.earthPositionAt(d);return b.equatorialToCartesian(d)};b.earthCartesianVelocityAt=function(d){var g=b.earthPositionAt(d);d=b.earthPositionAt(d.addMinutes(-1));g=b.equatorialToCartesian(g);d=b.equatorialToCartesian(d);return{x:(g.x-d.x)/7.04E-4,y:(g.y-d.y)/
7.04E-4,z:(g.z-d.z)/7.04E-4}};b.convertToHeliocentric=function(d,g){var a=b.earthCartesianPositionAt(g),e=b.geographicToCartesian(d,g);return{x:a.x+e.x,y:a.y+e.y,z:a.z+e.z}};b.calc_Ecliptic_MeanObliquity=function(d,g,b){g=g||d*d;return(21.448/60+26)/60+23+(-46.815*d-5.9E-4*g+.001813*(b||g*d))/3600};b.calc_Ecliptic_ObliquityCorrection=function(d,g){var a=g||b.calc_Ecliptic_MeanObliquity(d),e=b.calc_Sun_LongitudeOfAscendingNode(d);return a+.00256*Math.cos(b.D2R*e)};b.calc_Sun_Earth_Distance=function(d,
g,a,e,c){g=g||b.calc_Earth_OrbitEccentricity(d);a=a||b.calc_Sun_MeanAnomaly(d);e=e||b.calc_Sun_EqOfCenter(d,a);c=c||b.calc_Sun_TrueAnomaly(d,a,e);return.99972/(1+g*b.dcos(c))};b.calc_Sun_MeanLongitude=function(d){return b.normalize(280.46646+d*(36000.76983+3.032E-4*d))};b.calc_Sun_MeanAnomaly=function(d,g,a){g=g||d*d;return b.normalize(357.52772+35999.05034*d-1.603E-4*g-(a||d*g)/3E5)};b.calc_Sun_EqOfCenter=function(d,g){var a=g||b.calc_Sun_MeanAnomaly(d),a=b.D2R*a;return Math.sin(a)*(1.914602-d*(.004817+
1.4E-5*d))+Math.sin(a+a)*(.019993-1.01E-4*d)+2.89E-4*Math.sin(a+a+a)};b.calc_Sun_TrueLong=function(d,g,a){g=g||b.calc_Sun_MeanLongitude(d);d=a||b.calc_Sun_EqOfCenter(d);return g+d};b.calc_Sun_TrueAnomaly=function(d,g,a){g=g||b.calc_Sun_MeanAnomaly(d);d=a||b.calc_Sun_EqOfCenter(d);return g+d};b.calcSunRadVector=function(d,g,a){g=g||b.calc_Sun_TrueAnomaly(d);d=a||b.calc_Earth_OrbitEccentricity(d);return 1.000001018*(1-d*d)/(1+d*Math.cos(b.D2R*g))};b.calc_Sun_LongitudeOfAscendingNode=function(d,g,a){g=
g||d*d;return b.normalize(125.04452-1934.136261*d+.0020708*g+(a||g*d)/45E4)};b.calc_Sun_ApparentLong=function(d,g,a){g=g||b.calc_Sun_TrueLong(d);a=a||b.calc_Sun_LongitudeOfAscendingNode(d);return g-.00569-.00478*Math.sin(b.D2R*a)};b.calc_Moon_MeanAnomaly=function(d,g,a){g=g||d*d;return b.normalize(134.96298+477198.867398*d+.0086972*g+(a||g*d)/56250)};b.calc_Moon_MeanElongation=function(d,g,a){g=g||d*d;return b.normalize(297.85036+445267.11148*d-.0019142*g+(a||g*d)/189474)};b.calc_Moon_MeanLongitude=
function(d){return b.normalize(218.316+481267.8813*d)};b.calc_Moon_LongitudeAscendingNode=function(d,g,a){return b.normalize(125.045-1934.14*d+.002071*g+a/45E4)};b.calc_Moon_Earth_Distance=function(d,g){var a=2*g;return 1+(-20954*b.dcos(d)-3699*b.dcos(a-d)-2956*b.dcos(d))/385E3};b.calc_Moon_Sun_DistanceRatio=function(d,g){return d/g/379.168831168831};b.calc_Moon_GeocentricLatitude=function(d,g,a){a*=2;var e=5.128*b.dsin(d)+.2806*b.dsin(g+d);return e=e+.2777*b.dsin(g-d)+.1732*b.dsin(a-d)};b.calc_Moon_GeocentricLongitude=
function(d,g,a,e,c){g*=2;var f=6.289*b.dsin(d)+1.274*b.dsin(g-d)+.6583*b.dsin(g),f=f+.2136*b.dsin(2*d)-.1851*b.dsin(c)-.1143*b.dsin(2*e),f=f+.0588*b.dsin(g-2*d),f=f+.0572*b.dsin(g-c-d)+.0533*b.dsin(g+d);return f+a};b.calc_Moon_HeliocentricLatitude=function(d,g){return d*g};b.calc_Moon_HeliocentricLongitude=function(d,g,a,e){return b.normalize(d+180+180/Math.PI*g*b.dcos(a)*b.dsin(d-e))};b.calc_Moon_ArgumentOfLatitude=function(d,g,a){g=g||d*d;return b.normalize(93.27191+483202.017538*d-.0036825*g+(a||
g*d)/327270)};b.calc_Moon_LongitudeOfTerminator=function(d){var g=d.centuriesSinceJ2000,a=g*g,e=g*a;d=b.calc_Earth_OrbitEccentricity(g);var c=b.calc_Sun_MeanAnomaly(g,a,e),h=b.calc_Sun_EqOfCenter(g,c),k=b.calc_Sun_TrueAnomaly(g,c,h),l=b.calc_Sun_Earth_Distance(g,d,c,h,k);d=b.calc_Sun_LongitudeOfAscendingNode(g,a,e);var k=b.calc_Sun_MeanLongitude(g),h=b.calc_Sun_TrueLong(g,k,h),h=b.calc_Sun_ApparentLong(g,h,d),k=b.calc_Moon_MeanAnomaly(g,a,e),p=b.calc_Moon_MeanElongation(g,a,e),n=b.calc_Moon_Earth_Distance(k,
p),l=b.calc_Moon_Sun_DistanceRatio(n,l),a=b.calc_Moon_ArgumentOfLatitude(g,a,e),e=b.calc_Moon_GeocentricLatitude(a,k,p),g=b.calc_Moon_MeanLongitude(g),g=b.calc_Moon_GeocentricLongitude(k,p,g,a,c),c=b.calc_Moon_HeliocentricLatitude(l,e),g=b.calc_Moon_HeliocentricLongitude(h,l,c,g);d=b.normalize(g-d);g=b.dcos(d)*b.dcos(c);e=b.dsin(d)*b.dcos(c)*b.dcos(1.54242)-b.dsin(c)*b.dsin(1.54242);g=b.datan2(e,g);g=b.normalize(g-a);b.dasin(-b.dsin(d)*b.dcos(c)*b.dsin(1.54242)-b.dsin(c)*b.dcos(1.54242));d=90>g?90-
g:450-g;return f.Angle.fromDegrees(90<d&&270>d?180-d:90>d?0-d:360-d)};b.calc_Moon_IlluminatedDiscFraction=function(d){var g=d.centuriesSinceJ2000,a=g*g,e=g*a;d=b.calc_Earth_OrbitEccentricity(g);var c=b.calc_Sun_MeanAnomaly(g,a,e),f=b.calc_Sun_EqOfCenter(g,c),h=b.calc_Sun_TrueAnomaly(g,c,f);d=b.calc_Sun_Earth_Distance(g,d,c,f,h);var h=b.calc_Sun_LongitudeOfAscendingNode(g,a,e),k=b.calc_Sun_MeanLongitude(g),f=b.calc_Sun_TrueLong(g,k,f),k=b.calc_Sun_ApparentLong(g,f,h),l=b.calc_Moon_MeanAnomaly(g,a,
e),p=b.calc_Moon_MeanElongation(g,a,e),f=b.calc_Moon_Earth_Distance(l,p),f=b.calc_Moon_Sun_DistanceRatio(f,d),a=b.calc_Moon_ArgumentOfLatitude(g,a,e),e=b.calc_Moon_GeocentricLatitude(a,l,p),g=b.calc_Moon_MeanLongitude(g),c=b.calc_Moon_GeocentricLongitude(l,p,g,a,c),g=b.calc_Moon_HeliocentricLatitude(f,e),l=b.calc_Moon_HeliocentricLongitude(k,f,g,c),l=b.normalize(l-h),p=b.dcos(l)*b.dcos(g),h=b.dsin(l)*b.dcos(g)*b.dcos(1.54242)-b.dsin(g)*b.dsin(1.54242);b.normalize(b.datan2(h,p)-a);b.dasin(-b.dsin(l)*
b.dcos(g)*b.dsin(1.54242)-b.dsin(g)*b.dcos(1.54242));k=b.dcos(e)*b.dcos(c-k);h=90-b.datan(k/Math.sqrt(1-k*k));h=d*b.dsin(h);d=b.datan2(h,f-d*k);return(1+b.dcos(d))/2};b.calc_Ecliptic_NutationInLongitude=function(d,g,b,a,e,c){var f=-(171996+174.2*d)*Math.sin(g)-(13187+1.6*d)*Math.sin(-2*b+2*a+2*g)-(2274+.2*d)*Math.sin(2*a+2*g)+(2062+.2*d)*Math.sin(2*g)+(1426-3.4*d)*Math.sin(e)+(712+.1*d)*Math.sin(c),f=f+((-517+1.2*d)*Math.sin(-2*b+e+2*a+2*g)-(386+.4*d)*Math.sin(2*a+g)-301*Math.sin(c+2*a+2*g)+(217-
.5*d)*Math.sin(-2*b-e+2*a+2*g)-158*Math.sin(-2*b+c)),f=f+((129+.1*d)*Math.sin(-2*b+2*a+g)+123*Math.sin(-c+2*a+2*g)+63*Math.sin(2*b)+(63+.1*d)*Math.sin(c+g)-59*Math.sin(2*b-c+2*a+2*g)-(58+.1*d)*Math.sin(-c+g)),f=f-51*Math.sin(c+2*a+g),f=f+(48*Math.sin(-2*b+2*c)+46*Math.sin(-2*c+2*a+g)-38*Math.sin(2*b+2*a+2*g)-31*Math.sin(2*c+2*a+2*g)+29*Math.sin(2*c)+29*Math.sin(-2*b+c+2*a+2*g)+26*Math.sin(2*a)),f=f-(22*Math.sin(2*a-2*b)+21*Math.sin(2*a-c)+(17-.1*d)*Math.sin(2*e)+16*Math.sin(2*b-c+g)-(16-.1*d)*Math.sin(2*
(g+a+e-b))-15*Math.sin(e+g)-13*Math.sin(g+c-2*b)-12*Math.sin(g-e)),f=f+(11*Math.sin(2*(c-a))-10*Math.sin(2*b-c+2*a)-8*Math.sin(2*b+c+2*a+2*g)+7*Math.sin(e+2*a+2*g)-7*Math.sin(e+c-2*b)-7*Math.sin(2*a+2*g-e)-7*Math.sin(2*b+2*a+g)),f=f+6*Math.sin(2*b+c),f=f+(6*Math.sin(2*(g+a+c-b))+6*Math.sin(g+2*a+c-2*b)-6*Math.sin(2*b-2*c+g)-6*Math.sin(2*b+g)+5*Math.sin(c-e)-5*Math.sin(g+2*a-e-2*b)-5*Math.sin(g-2*b)-5*Math.sin(g+2*a+2*c)),f=f+(4*Math.sin(g-2*c-2*b)+4*Math.sin(g+2*a+e-2*b)+4*Math.sin(c-2*a)-4*Math.sin(c-
b)-4*Math.sin(e-2*b)-4*Math.sin(b)+3*Math.sin(2*a+c)-3*Math.sin(2*(g+a-c))-3*Math.sin(c-e-b)),f=f-3*Math.sin(c+e),f=f-(3*Math.sin(2*g+2*a+c-e)-3*Math.sin(2*g+2*a-c-e+2*b)-3*Math.sin(2*g+2*a+3*c)-3*Math.sin(2*g+2*a-e+2*b));return 1E-4/3600*f};b.calc_Ecliptic_MeanObliquityCorrection=function(d,g,b,a,e,c,f,h){g=(92025+8.9*d)*Math.cos(a)+(5736-3.1*d)*Math.cos(-2*e+2*c+2*a)+(977-.5*d)*Math.cos(2*c+2*a)+(-895+.5*d)*Math.cos(2*a)+(54-.1*d)*Math.cos(f)-7*Math.cos(h);g+=(224-.6*d)*Math.cos(-2*e+f+2*c+2*a)+
200*Math.cos(2*c+a)+(129-.1*d)*Math.cos(h+2*c+2*a)+(-95+.3*d)*Math.cos(-2*e-f+2*c+2*a)-70*Math.cos(-2*e+2*c+a);g-=53*Math.cos(-h+2*c+2*a)-33*Math.cos(h+a)+26*Math.cos(2*e-h+2*c+2*a)+32*Math.cos(-h+a)+27*Math.cos(h+2*c+a)-24*Math.cos(-2*h+2*c+a);g+=16*Math.cos(2*(e+c+a))+13*Math.cos(2*(h+c+a))-12*Math.cos(2*a+2*c+h-2*e)-10*Math.cos(a+2*c-h)-8*Math.cos(2*e-h+a)+7*Math.cos(2*(a+c+f-e))+9*Math.cos(f+a);g+=7*Math.cos(a+h-2*e)+6*Math.cos(a-f)+5*Math.cos(a+2*c-h+2*e)+3*Math.cos(2*a+2*c+h+2*e)-3*Math.cos(2*
a+2*c+f)+3*Math.cos(2*a+2*c-f)+3*Math.cos(a+2*c+2*e);g-=3*Math.cos(2*(a+c+h-e))-3*Math.cos(a+2*c+h-2*e)+3*Math.cos(a-2*h+2*e)+3*Math.cos(a+2*e)+3*Math.cos(a+2*c-f-2*e)+3*Math.cos(a-2*e)+3*Math.cos(a+2*c+2*h);return 1E-4/3600*g};b.toGasDegrees=function(d){d=d.daysSinceJ2000;var a=d/36525,e=a*a,c=e*a,f=b.calc_Moon_MeanElongation(a,e,c)*b.D2R,h=b.calc_Sun_MeanAnomaly(a,e,c)*b.D2R,k=b.calc_Moon_MeanAnomaly(a,e,c)*b.D2R,l=b.calc_Moon_ArgumentOfLatitude(a,e,c)*b.D2R,p=b.calc_Sun_LongitudeOfAscendingNode(a,
e,c)*b.D2R,n=b.calc_Ecliptic_NutationInLongitude(a,p,f,l,h,k),a=b.calc_Ecliptic_MeanObliquity(a,e,c)+b.calc_Ecliptic_MeanObliquityCorrection(a,e,c,p,f,l,h,k);d=280.46061837+360.98564736629*d+3.87933E-4*e-c/3871E4+n*Math.cos(a*b.D2R);return d=b.normalize(d)};b.correctForRefraction=function(d){d instanceof f.Angle&&(d=d.degrees);var a=1/Math.tan((d+7.31/(d+4.4))*b.D2R),a=a-.06*Math.sin((14.7*a/60+13)*b.D2R);return f.Angle.fromDegrees(d+a/60)};b.uncorrectRefraction=function(d){d instanceof f.Angle&&
(d=d.degrees);var a=1/Math.tan((d+7.31/(d+4.4))*b.D2R),a=a-.06*Math.sin((14.7*a/60+13)*b.D2R);return d-a/60};b.toTopocentric=function(d){d instanceof f.Angle&&(d=d.degrees);return b.correctForRefraction(d-Math.atan(Math.cos(d*b.D2R)/(1E10-Math.sin(d*b.D2R)))*b.R2D)};b.toGeocentric=function(d){d instanceof f.Angle&&(d=d.degrees);d=b.uncorrectRefraction(d);return f.Angle.fromDegrees(d+Math.atan(Math.cos(d*b.D2R)/(1E10-Math.sin(d*b.D2R)))*b.R2D)};b.toUnitVector=function(d){var a=d.declination.radians;
d=d.rightAscension.radians;var b=[];b.push(Math.cos(a)*Math.cos(d));b.push(Math.cos(a)*Math.sin(d));b.push(Math.sin(a));return b};b.fromUnitVector=function(d){var a=Math.asin(d[2]);return new r.EquatorialCoordinates(f.Angle.fromRadians(Math.atan2(d[1],d[0])),f.Angle.fromRadians(a))};b.precesionMatrixParams=function(d){var a=d.centuriesSinceJ2000,b=a*a,e=b*a;d=.011180860865024398*a+1.4635555405334672E-6*b+Math.pow(8.72567663260943,-8)*e;var c=.011180860865024398*a+5.307158404369869E-6*b+Math.pow(8.825063437236881,
-8)*e,a=.009717173455169672*a+2.068457570453835E-6*b+Math.pow(2.0281210721855225,-7)*e;return{p00:Math.cos(c)*Math.cos(a)*Math.cos(d)-Math.sin(c)*Math.sin(d),p01:-Math.cos(c)*Math.cos(a)*Math.sin(d)-Math.sin(c)*Math.cos(d),p02:-Math.cos(c)*Math.sin(a),p10:Math.sin(c)*Math.cos(a)*Math.cos(d)+Math.cos(c)*Math.sin(d),p11:-Math.sin(c)*Math.cos(a)*Math.sin(d)+Math.cos(c)*Math.cos(d),p12:-Math.sin(c)*Math.sin(a),p20:Math.sin(a)*Math.cos(d),p21:-Math.sin(a)*Math.sin(d),p22:Math.cos(a)}};b.determinant3x3=
function(d){return d[0][0]*d[1][1]*d[2][2]-d[0][0]*d[1][2]*d[2][1]-d[0][1]*d[1][0]*d[2][2]+d[0][1]*d[1][2]*d[2][0]+d[0][2]*d[1][0]*d[2][1]-d[0][2]*d[1][1]*d[2][0]};b.inverse3x3=function(d){var a=b.determinant3x3(d);return[[(d[1][1]*d[2][2]-d[1][2]*d[2][1])/a,(d[0][2]*d[2][1]-d[0][1]*d[2][2])/a,(d[0][1]*d[1][2]-d[0][2]*d[1][1])/a],[(d[1][2]*d[2][0]-d[1][0]*d[2][2])/a,(d[0][0]*d[2][2]-d[0][2]*d[2][0])/a,(d[0][2]*d[1][0]-d[0][0]*d[1][2])/a],[(d[1][0]*d[2][1]-d[1][1]*d[2][0])/a,(d[0][1]*d[2][0]-d[0][0]*
d[2][1])/a,(d[0][0]*d[1][1]-d[0][1]*d[1][0])/a]]};b.inversePrecesionMatrixAt=function(d){d=b.precesionMatrixParams(d);return[[d.p00,d.p10,d.p20],[d.p01,d.p11,d.p21],[d.p02,d.p12,d.p22]]};b.precesionMatrixAt=function(d){d=b.precesionMatrixParams(d);return[[d.p00,d.p01,d.p02],[d.p10,d.p11,d.p12],[d.p20,d.p21,d.p22]]};b.matrixTimesMatrix=function(d,a){return[[d[0][0]*a[0][0]+d[0][1]*a[1][0]+d[0][2]*a[2][0],d[0][0]*a[0][1]+d[0][1]*a[1][1]+d[0][2]*a[2][1],d[0][0]*a[0][2]+d[0][1]*a[1][2]+d[0][2]*a[2][2]],
[d[1][0]*a[0][0]+d[1][1]*a[1][0]+d[1][2]*a[2][0],d[1][0]*a[0][1]+d[1][1]*a[1][1]+d[1][2]*a[2][1],d[1][0]*a[0][2]+d[1][1]*a[1][2]+d[1][2]*a[2][2]],[d[2][0]*a[0][0]+d[2][1]*a[1][0]+d[2][2]*a[2][0],d[2][0]*a[0][1]+d[2][1]*a[1][1]+d[2][2]*a[2][1],d[2][0]*a[0][2]+d[2][1]*a[1][2]+d[2][2]*a[2][2]]]};b.matrixTimesVector=function(a,b){return[a[0][0]*b[0]+a[0][1]*b[1]+a[0][2]*b[2],a[1][0]*b[0]+a[1][1]*b[1]+a[1][2]*b[2],a[2][0]*b[0]+a[2][1]*b[1]+a[2][2]*b[2]]};b.fromJ2000=function(a,g){var c=b.toUnitVector(a),
e=b.precesionMatrixAt(g),c=b.matrixTimesVector(e,c);return b.fromUnitVector(c)};b.toJ2000=function(a,g){var c=b.toUnitVector(a),e=b.inversePrecesionMatrixAt(g),c=b.matrixTimesVector(e,c);return b.fromUnitVector(c)};b.toEpoch=function(a,g){var c=g.centuriesSinceJ2000,e=c*c,h=c*e,k;k=b.D2R/3600*(2306.2181*c+.30188*e+.017998*h);var l;l=b.D2R/3600*(2306.2181*c+1.09468*e+.018203*h);var h=b.D2R/3600*(2004.3109*c-.42665*e-.041833*h),p=a.rightAscension.radians,c=a.declination.radians,e=Math.cos(c)*Math.sin(p+
k);k=Math.cos(h)*Math.cos(c)*Math.cos(p+k)-Math.sin(h)*Math.sin(c);l=Math.atan2(e,k)+l;0>l?l+=b.PI2:l>b.PI2&&(l-=b.PI2);l*=b.R2D;k=Math.acos(Math.sqrt(e*e+k*k));0>k*c&&(k=-k);k*=b.R2D;return new r.EquatorialCoordinates(f.Angle.fromDegrees(l),f.Angle.fromDegrees(k))};b.calc_SunriseOrSunset_UTC=function(a,g,c,e){var f=g.centuriesSinceJ2000;g=b.calc_EquationOfTime(f);f=b.calc_Sun_Declination(f);a=b.calcHourAngleSunriseOrSunset(a,c.latitude.degrees,f,e);return 720-4*(c.longitude.degrees+b.R2D*a)-g};b.prepareJd=
function(a){if(a instanceof Date)a=h.UtcDate.fromDate(a);else if(!(a instanceof h.UtcDate))throw"date";return a};b.calc_SunriseOrSunset=function(a,g,c,e){var f=g.toDate();g=new h.UtcDate(h.UtcDate.toUtcDays(f.getFullYear(),f.getMonth(),f.getDate()));var k=-f.getTimezoneOffset()/60,f=b.isDaylightSavingsTime(f),l=c.latitude.degrees,p=c.longitude.degrees,n=b.calc_SunriseOrSunset_UTC(a,g,c,e);c=b.calc_SunriseOrSunset_UTC(a,g.addMinutes(n),c,e);if("number"==typeof c){a=c;if(0<=a&&1440>a)return g.addMinutes(a);
g=g.days;for(k=0>a?1:-1;0>a||1440<=a;)a+=1440*k,g-=k;return(new h.UtcDate(g)).addMinutes(a)}c=b.calcDoyFromJD(g.days);66.4<l&&79<c&&267>c||-66.4>l&&(83>c||263<c)?a?b.calc_JDofNextPrevRiseSet(0,a,g.days,l,p,k,f):b.calc_JDofNextPrevRiseSet(1,a,g.days,l,p,k,f):1==a?b.calc_JDofNextPrevRiseSet(1,a,g.days,l,p,k,f):b.calc_JDofNextPrevRiseSet(0,a,g.days,l,p,k,f);throw"notimplementedyet";};b.calc_JDofNextPrevRiseSet=function(a,g,c,e,f,h,k){a=a?1:-1;for(var l=b.calc_SunriseOrSunset_UTC(g,c,e,f);"number"!=typeof l;)c+=
a,l=b.calc_SunriseOrSunset_UTC(g,c,e,f);for(g=l+60*h+(k?60:0);0>g||1440<=g;)e=0>g?1:-1,g+=1440*e,c-=e;return c};b.isLeapYear=function(a){return 0==a%4&&0!=a%100||0==a%400};b.calcDoyFromJD=function(a){var c=Math.floor(a+.5);if(2299161>c)var e=c;else e=Math.floor((c-1867216.25)/36524.25),e=c+1+e-Math.floor(e/4);var f=e+1524,e=Math.floor((f-122.1)/365.25),h=Math.floor(365.25*e),k=Math.floor((f-h)/30.6001);a=f-h-Math.floor(30.6001*k)+(a+.5-c);c=14>k?k-1:k-13;e=b.isLeapYear(2<c?e-4716:e-4715)?1:2;return Math.floor(275*
c/9)-e*Math.floor((c+9)/12)+a-30};b.calcSunRa=function(a,c,e){c=c||b.calc_Ecliptic_ObliquityCorrection(a);a=e||b.calc_Sun_ApparentLong(a);return b.R2D*Math.atan2(Math.cos(b.D2R*c)*Math.sin(b.D2R*a),Math.cos(b.D2R*a))};b.calc_Sun_Declination=function(a,c,e){c=c||b.calc_Ecliptic_ObliquityCorrection(a);a=e||b.calc_Sun_ApparentLong(a);return b.R2D*Math.asin(Math.sin(b.D2R*c)*Math.sin(b.D2R*a))};b.calc_EquationOfTime=function(a,c,e,f,h){c=c||b.calc_Ecliptic_ObliquityCorrection(a);e=e||b.calc_Sun_MeanLongitude(a);
f=f||b.calc_Earth_OrbitEccentricity(a);a=h||b.calc_Sun_MeanAnomaly(a);h=Math.tan(b.D2R*c/2);h*=h;c=Math.sin(b.D2R*a);e=h*Math.sin(2*b.D2R*e)-2*f*c+4*f*h*c*Math.cos(2*b.D2R*e)-.5*h*h*Math.sin(4*b.D2R*e)-1.25*f*f*Math.sin(2*b.D2R*a);return e=b.R2D*e*4};b.getHRadians=function(a){var b=0;switch(a){case q.Astronomical:b=18;break;case q.Nautical:b=12;break;case q.Civil:b=6;break;case q.Official:b=.833;break;default:throw"twilight";}return b+90};b.calcHourAngleSunriseOrSunset=function(a,c,e,f){c*=b.D2R;
e*=b.D2R;f=b.getHRadians(f);f=Math.acos(Math.cos(b.D2R*f)/(Math.cos(c)*Math.cos(e))-Math.tan(c)*Math.tan(e));return a?f:-f};b.isDaylightSavingsTime=function(a){var b=new Date(a.getFullYear(),0,1),c=new Date(a.getFullYear(),6,1),b=Math.max(b.getTimezoneOffset(),c.getTimezoneOffset());return a.getTimezoneOffset()<b};b.calcAzEl=function(a,c,e,f,h){var k=b.calc_EquationOfTime(a),l=b.calc_Sun_Declination(a);f=k+4*f-60*h;b.calcSunRadVector(a);for(a=c+f;1440<a;)a-=1440;a=a/4-180;-180>a&&(a+=360);c=Math.sin(b.D2R*
e)*Math.sin(b.D2R*l)+Math.cos(b.D2R*e)*Math.cos(b.D2R*l)*Math.cos(b.D2R*a);1<c?c=1:-1>c&&(c=-1);c=b.R2D*Math.acos(c);f=Math.cos(b.D2R*e)*Math.sin(b.D2R*c);.001<Math.abs(f)?(e=(Math.sin(b.D2R*e)*Math.cos(b.D2R*c)-Math.sin(b.D2R*l))/f,1<Math.abs(e)&&(e=0>e?-1:1),e=180-b.R2D*Math.acos(e),0<a&&(e=-e)):e=0<e?180:0;0>e&&(e+=360);return e};b.PI=Math.PI;b.PI2=2*Math.PI;b.D2R=Math.PI/180;b.R2D=180/Math.PI;b.MinsPerAU=8.3168775;b.TaiToTtOffsetSeconds=32.184;b.LeapSeconds=[{utcdays:2457204.5,taiutc:{p1:36,p2:41317,
p3:0}},{utcdays:2456109.5,taiutc:{p1:35,p2:41317,p3:0}},{utcdays:2454832.5,taiutc:{p1:34,p2:41317,p3:0}},{utcdays:2453736.5,taiutc:{p1:33,p2:41317,p3:0}},{utcdays:2451179.5,taiutc:{p1:32,p2:41317,p3:0}},{utcdays:2450630.5,taiutc:{p1:31,p2:41317,p3:0}},{utcdays:2450083.5,taiutc:{p1:30,p2:41317,p3:0}},{utcdays:2449534.5,taiutc:{p1:29,p2:41317,p3:0}},{utcdays:2449169.5,taiutc:{p1:28,p2:41317,p3:0}},{utcdays:2448804.5,taiutc:{p1:27,p2:41317,p3:0}},{utcdays:2448257.5,taiutc:{p1:26,p2:41317,p3:0}},{utcdays:2447892.5,
taiutc:{p1:25,p2:41317,p3:0}},{utcdays:2447161.5,taiutc:{p1:24,p2:41317,p3:0}},{utcdays:2446247.5,taiutc:{p1:23,p2:41317,p3:0}},{utcdays:2445516.5,taiutc:{p1:22,p2:41317,p3:0}},{utcdays:2445151.5,taiutc:{p1:21,p2:41317,p3:0}},{utcdays:2444786.5,taiutc:{p1:20,p2:41317,p3:0}},{utcdays:2444239.5,taiutc:{p1:19,p2:41317,p3:0}},{utcdays:2443874.5,taiutc:{p1:18,p2:41317,p3:0}},{utcdays:2443509.5,taiutc:{p1:17,p2:41317,p3:0}},{utcdays:2443144.5,taiutc:{p1:16,p2:41317,p3:0}},{utcdays:2442778.5,taiutc:{p1:15,
p2:41317,p3:0}},{utcdays:2442413.5,taiutc:{p1:14,p2:41317,p3:0}},{utcdays:2442048.5,taiutc:{p1:13,p2:41317,p3:0}},{utcdays:2441683.5,taiutc:{p1:12,p2:41317,p3:0}},{utcdays:2441499.5,taiutc:{p1:11,p2:41317,p3:0}},{utcdays:2441317.5,taiutc:{p1:10,p2:41317,p3:0}},{utcdays:2439887.5,taiutc:{p1:4.21317,p2:39126,p3:.002592}},{utcdays:2439126.5,taiutc:{p1:4.31317,p2:39126,p3:.002592}},{utcdays:2439004.5,taiutc:{p1:3.84013,p2:38761,p3:.001296}},{utcdays:2438942.5,taiutc:{p1:3.74013,p2:38761,p3:.001296}},
{utcdays:2438820.5,taiutc:{p1:3.64013,p2:38761,p3:.001296}},{utcdays:2438761.5,taiutc:{p1:3.54013,p2:38761,p3:.001296}},{utcdays:2438639.5,taiutc:{p1:3.44013,p2:38761,p3:.001296}},{utcdays:2438486.5,taiutc:{p1:3.34013,p2:38761,p3:.001296}},{utcdays:2438395.5,taiutc:{p1:3.24013,p2:38761,p3:.001296}},{utcdays:2438334.5,taiutc:{p1:1.945858,p2:37665,p3:.0011232}},{utcdays:2437665.5,taiutc:{p1:1.845858,p2:37665,p3:.0011232}},{utcdays:2437512.5,taiutc:{p1:1.372818,p2:37300,p3:.001296}},{utcdays:2437300.5,
taiutc:{p1:1.422818,p2:37300,p3:.001296}}];return b}();l.MeeusEngine=k},{"../angle":1,"../coordinateSystems/equatorialCoordinates":3,"../coordinateSystems/geographicCoordinates":4,"../coordinateSystems/horizontalCoordinates":5,"../datetime/hjddate":7,"../datetime/siderealtimes":8,"../datetime/taidate":9,"../datetime/ttdate":10,"../datetime/utcdate":11}],7:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});f.prototype.addDays=function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=function(h){return new f(this.days+
h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.HjdDate=k},{}],8:[function(k,n,l){var f=this&&this.__extends||function(c,a){function e(){this.constructor=c}for(var f in a)a.hasOwnProperty(f)&&(c[f]=a[f]);c.prototype=null===a?Object.create(a):(e.prototype=a.prototype,new e)},h=k("./utcdate");k=function(){function c(a){this._hours=a}Object.defineProperty(c.prototype,"hours",{get:function(){return this._hours},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"hour",{get:function(){return 0|this._hours},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"minutes",{get:function(){return 60*(this.hours-this.hour)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"minute",{get:function(){return 0|this.minutes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"seconds",{get:function(){return 60*(this.minutes-this.minute)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"second",{get:function(){return 0|
this.seconds},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"milliseconds",{get:function(){return 1E3*(this.seconds-this.second)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"millisecond",{get:function(){return 0|this.milliseconds},enumerable:!0,configurable:!0});c.prototype.toFormattedString=function(){var a=Math.round(this.seconds),e=Math.round(this.minute),f=this.hour;60==a&&(e+=1,a=0);60<=e&&(f+=1,e-=60);return c.absPad(f)+":"+c.absPad(e)+":"+c.absPad(a)};
c.absPad=function(a,c){var f=Math.abs(a).toFixed(c||0),h=parseFloat(f);return(10>h&&-10<h?"0":"")+f};return c}();l.__BaseTime=k;n=function(c){function a(){c.apply(this,arguments)}f(a,c);a.fromDate=function(a){return h.UtcDate.fromDate(a).toGmsTime()};return a}(k);l.GmsTime=n;n=function(c){function a(){c.apply(this,arguments)}f(a,c);return a}(k);l.LmsTime=n;n=function(c){function a(){c.apply(this,arguments)}f(a,c);a.fromDate=function(a){return h.UtcDate.fromDate(a).toGasTime()};return a}(k);l.GasTime=
n;k=function(c){function a(){c.apply(this,arguments)}f(a,c);return a}(k);l.LasTime=k},{"./utcdate":11}],9:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},
enumerable:!0,configurable:!0});f.prototype.addDays=function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=function(h){return new f(this.days+h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.TaiDate=k},{}],10:[function(k,n,l){k=function(){function f(f){this._days=f}Object.defineProperty(f.prototype,"days",{get:function(){return this._days},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});f.prototype.addDays=function(h){return new f(this.days+h)};f.prototype.addHours=function(h){return new f(this.days+h/24)};f.prototype.addMinutes=function(h){return new f(this.days+h/1440)};f.prototype.addSeconds=
function(h){return new f(this.days+h/86400)};f.prototype.addMilliseconds=function(h){return new f(this.days+h/864E5)};return f}();l.TtDate=k},{}],11:[function(k,n,l){var f=k("../core/meeusEngine");k=function(){function h(c){this._days=void 0===c?h.getJulianDays(new Date):c}Object.defineProperty(h.prototype,"days",{get:function(){return this._days},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"daysSinceJ2000",{get:function(){return this._days-2451545},enumerable:!0,configurable:!0});
Object.defineProperty(h.prototype,"centuriesSinceJ2000",{get:function(){return this.daysSinceJ2000/36525},enumerable:!0,configurable:!0});Object.defineProperty(h,"J2000",{get:function(){return new h(2451545)},enumerable:!0,configurable:!0});Object.defineProperty(h,"B1950",{get:function(){return new h(2433282.4229166666)},enumerable:!0,configurable:!0});h.prototype.addDays=function(c){return new h(this.days+c)};h.prototype.addHours=function(c){return new h(this.days+c/24)};h.prototype.addMinutes=function(c){return new h(this.days+
c/1440)};h.prototype.addSeconds=function(c){return new h(this.days+c/86400)};h.prototype.addMilliseconds=function(c){return new h(this.days+c/864E5)};h.prototype.toDate=function(){var c,a,e,f,h,k;k=this.days+.5;c=Math.floor(k);2299161>c?a=c:(a=Math.floor((c-1867216.25)/36524.25),a=c+1+a-Math.floor(a/4));e=a+1524;a=Math.floor((e-122.1)/365.25);f=Math.floor(365.25*a);h=Math.floor((e-f)/30.6);k=e-f-Math.floor(30.6001*h)+(k-c);c=13<h?0|h-13:0|h-1;h=24*(k-(0|k));a=new Date(1==c||2==c?0|a-4715:0|a-4716,
c-1,0|k);return new Date(a.getTime()+6E4*(60*h-a.getTimezoneOffset()))};h.prototype.toLmsTime=function(c){return f.MeeusEngine.toLmsTime(this,c)};h.prototype.toGmsTime=function(){return f.MeeusEngine.toGmsTime(this)};h.prototype.toLasTime=function(c){return f.MeeusEngine.toLasTime(this,c)};h.prototype.toGasTime=function(){return f.MeeusEngine.toGasTime(this)};h.prototype.toTaiDate=function(){return f.MeeusEngine.toTaiDate(this)};h.prototype.toTtDate=function(){return f.MeeusEngine.toTtDate(this)};
h.prototype.toHjdDate=function(c,a){return f.MeeusEngine.toHjdDate(this,c,a)};h.fromDate=function(c){return new h(h.getJulianDays(c))};h.fromJ2000Centuries=function(c){return new h(36525*c+2451545)};h.isJulianCalendar=function(c,a,e){if(1582>c)return!0;if(1582<c)return!1;if(10>a)return!0;if(10<a)return!1;if(5>e)return!0;if(14<e)return!1;throw"This date is not valid as it does not exist in either the Julian or the Gregorian calendars.";};h.getJulianDays=function(c){var a=c.getUTCFullYear(),e=c.getUTCMonth(),
f=c.getUTCDate(),k=c.getUTCHours(),l=c.getUTCMinutes(),n=c.getUTCSeconds();c=c.getUTCMilliseconds();return h.toUtcDays(a,e,f,k,l,n,c)};h.toUtcDays=function(c,a,e,f,k,l,n){a+=1;f=f||0;k=k||0;l=l||0;n=n||0;var q=h.isJulianCalendar(c,a,e);c=2<a?c:c-1;var b=Math.floor(c/100);return(q?0:2-b+Math.floor(b/4))+Math.floor(365.25*(c+4716))+Math.floor(30.6001*((2<a?a:a+12)+1))-1524.5+e+f/24+k/1440+(l+n/1E3)/86400};return h}();l.UtcDate=k},{"../core/meeusEngine":6}],12:[function(k,n,l){function f(f){for(var c in f)l.hasOwnProperty(c)||
(l[c]=f[c])}f(k("./angle"));f(k("./solarSystem/moon"));f(k("./solarSystem/earth"));f(k("./solarSystem/sun"));f(k("./datetime/hjddate"));f(k("./datetime/siderealtimes"));f(k("./datetime/taidate"));f(k("./datetime/ttdate"));f(k("./datetime/utcdate"));f(k("./coordinateSystems/eclipticCoordinates"));f(k("./coordinateSystems/equatorialCoordinates"));f(k("./coordinateSystems/geographicCoordinates"));f(k("./coordinateSystems/horizontalCoordinates"));f(k("./core/meeusEngine"))},{"./angle":1,"./coordinateSystems/eclipticCoordinates":2,
"./coordinateSystems/equatorialCoordinates":3,"./coordinateSystems/geographicCoordinates":4,"./coordinateSystems/horizontalCoordinates":5,"./core/meeusEngine":6,"./datetime/hjddate":7,"./datetime/siderealtimes":8,"./datetime/taidate":9,"./datetime/ttdate":10,"./datetime/utcdate":11,"./solarSystem/earth":13,"./solarSystem/moon":14,"./solarSystem/sun":15}],13:[function(k,n,l){var f=k("../core/meeusEngine"),h=k("../datetime/utcdate");k=function(){function c(){}c.orbitalEccentricity=function(a){var c=
a;c instanceof Date&&(c=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianPositionAt(c)};c.cartesianPositionAt=function(a){var c=a;c instanceof Date&&(c=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianPositionAt(c)};c.cartesianVelocityAt=function(a){var c=a;c instanceof Date&&(c=h.UtcDate.fromDate(a));return f.MeeusEngine.earthCartesianVelocityAt(c)};return c}();l.Earth=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}],14:[function(k,n,l){var f=k("../datetime/utcdate"),h=k("../core/meeusEngine");
k=function(){function c(){}c.positionAt=function(a){var c=a;c instanceof Date&&(c=f.UtcDate.fromDate(a));return h.MeeusEngine.moonPositionAt(c)};c.terminatorLongitudeAt=function(a){var c=a;c instanceof Date&&(c=f.UtcDate.fromDate(a));return h.MeeusEngine.calc_Moon_LongitudeOfTerminator(c)};c.illuminatedDiscFractionAt=function(a){var c=a;c instanceof Date&&(c=f.UtcDate.fromDate(a));return h.MeeusEngine.calc_Moon_IlluminatedDiscFraction(c)};return c}();l.Moon=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}],
15:[function(k,n,l){var f=k("../datetime/utcdate"),h=k("../core/meeusEngine");k=function(){function c(){}c.positionAt=function(a){var c=a;c instanceof Date&&(c=f.UtcDate.fromDate(a));return h.MeeusEngine.sunPositionAt(c)};return c}();l.Sun=k},{"../core/meeusEngine":6,"../datetime/utcdate":11}]},{},[12])(12)});

